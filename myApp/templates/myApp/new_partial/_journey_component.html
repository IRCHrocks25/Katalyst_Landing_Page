<script type="text/babel">
    // Wait for React to be available before defining components
    function initReactApp() {
        if (typeof React === 'undefined' || typeof ReactDOM === 'undefined') {
            console.log('Waiting for React...');
            setTimeout(initReactApp, 100);
            return;
        }

        const { useState, useEffect, useMemo } = React;

        function ContactFormComponent({ node, go }) {
            if (!node) {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center">
                        <div className="text-white">Loading form...</div>
                    </div>
                );
            }

            const [formData, setFormData] = useState({
                name: '',
                email: '',
                company: '',
                service: '',
                message: ''
            });
            const [submitted, setSubmitted] = useState(false);

            const handleSubmit = (e) => {
                e.preventDefault();
                console.log('Form submitted:', formData);
                setSubmitted(true);
                setTimeout(() => {
                    window.location.href = 'mailto:hello@katalyst-crm.com?subject=' + encodeURIComponent(formData.service) + '&body=' + encodeURIComponent(`Name: ${formData.name}\nEmail: ${formData.email}\nCompany: ${formData.company}\n\nMessage: ${formData.message}`);
                }, 1000);
            };

            if (submitted) {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center">
                        <div className="max-w-2xl mx-auto px-6 w-full text-center">
                            <div className="bg-gradient-to-br from-dark-slate-2/90 to-deep-navy/90 backdrop-blur-xl rounded-3xl p-12 border border-white/10">
                                <div className="w-20 h-20 rounded-full bg-gradient-to-r from-electric-pink to-electric-blue flex items-center justify-center mx-auto mb-6">
                                    <i className="fas fa-check text-white text-3xl"></i>
                                </div>
                                <h2 className="text-4xl font-bold mb-4">Thank You!</h2>
                                <p className="text-white/80 text-lg mb-8">We've received your message and will get back to you within 24 hours.</p>
                                <button
                                    onClick={() => go('home_hero')}
                                    className="px-8 py-4 rounded-xl bg-gradient-to-r from-electric-pink to-electric-blue text-white font-semibold hover:scale-105 transition-transform"
                                >
                                    Return Home
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="relative z-10 min-h-[calc(100vh-84px)] flex items-center py-12">
                    <div className="max-w-5xl mx-auto px-6 w-full">
                        <div className="grid lg:grid-cols-5 gap-8 lg:gap-12 items-start">
                            {/* Left Side - Header */}
                            <div className="lg:col-span-2 space-y-6 lg:sticky lg:top-24">
                                <div>
                                    <h1 className="text-3xl md:text-4xl lg:text-5xl font-bold text-white leading-tight mb-4">
                                        {node.title}
                                    </h1>
                                    {node.subtitle && (
                                        <div className="text-lg md:text-xl text-cyan-teal font-light leading-relaxed">
                                            {node.subtitle}
                                        </div>
                                    )}
                                </div>
                                
                                {node.body && (
                                    <div className="pt-4 border-t border-white/10">
                                        <div className="flex items-start gap-3 text-white/70 text-sm">
                                            <i className="fas fa-clock text-cyan-teal mt-1"></i>
                                            <p className="leading-relaxed">{node.body}</p>
                                        </div>
                                    </div>
                                )}

                                {/* Navigation buttons */}
                                <div className="flex flex-col gap-3 pt-4">
                                    {node.choices?.map((c, idx) => (
                                        <button
                                            key={idx}
                                            onClick={(e) => {
                                                e.preventDefault();
                                                e.stopPropagation();
                                                go(c.to);
                                            }}
                                            className="group relative px-5 py-3 rounded-xl bg-white/5 hover:bg-white/10 border border-white/20 hover:border-cyan-teal/50 text-white font-medium transition-all duration-300 text-left backdrop-blur-sm pointer-events-auto"
                                        >
                                            <div className="absolute inset-0 bg-gradient-to-r from-electric-pink/0 via-electric-blue/0 to-cyan-teal/0 group-hover:from-electric-pink/10 group-hover:via-electric-blue/10 group-hover:to-cyan-teal/10 rounded-xl transition-all"></div>
                                            <span className="relative z-10 flex items-center gap-2">
                                                <i className="fas fa-arrow-left text-sm opacity-60"></i>
                                                <span>{c.label}</span>
                                            </span>
                                        </button>
                                    ))}
                                </div>
                            </div>

                            {/* Right Side - Form Card */}
                            <div className="lg:col-span-3">
                                <div className="relative">
                                    {/* Glow effect */}
                                    <div className="absolute -inset-3 bg-gradient-to-r from-electric-pink/30 via-electric-blue/30 to-cyan-teal/30 rounded-3xl blur-2xl opacity-40"></div>
                                    
                                    {/* Main card */}
                                    <div className="relative bg-gradient-to-br from-dark-slate-2/95 via-dark-slate-2/90 to-deep-navy/95 backdrop-blur-2xl rounded-3xl p-8 md:p-10 border border-white/20 shadow-2xl">
                                        {/* Top accent line */}
                                        <div className="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal rounded-t-3xl"></div>
                                        <form onSubmit={handleSubmit} className="space-y-6 mt-6">
                                            <div className="grid md:grid-cols-2 gap-5">
                                                <div className="space-y-2">
                                                    <label className="block text-white/90 mb-2 font-semibold text-sm">
                                                        Full Name <span className="text-electric-pink">*</span>
                                                    </label>
                                                    <input
                                                        type="text"
                                                        required
                                                        value={formData.name}
                                                        onChange={(e) => setFormData({...formData, name: e.target.value})}
                                                        className="w-full px-4 py-3.5 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:border-cyan-teal focus:ring-2 focus:ring-cyan-teal/30 transition-all backdrop-blur-sm"
                                                        placeholder="John Doe"
                                                    />
                                                </div>
                                                <div className="space-y-2">
                                                    <label className="block text-white/90 mb-2 font-semibold text-sm">
                                                        Email Address <span className="text-electric-pink">*</span>
                                                    </label>
                                                    <input
                                                        type="email"
                                                        required
                                                        value={formData.email}
                                                        onChange={(e) => setFormData({...formData, email: e.target.value})}
                                                        className="w-full px-4 py-3.5 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:border-cyan-teal focus:ring-2 focus:ring-cyan-teal/30 transition-all backdrop-blur-sm"
                                                        placeholder="john@company.com"
                                                    />
                                                </div>
                                            </div>

                                            <div className="grid md:grid-cols-2 gap-5">
                                                <div className="space-y-2">
                                                    <label className="block text-white/90 mb-2 font-semibold text-sm">Company Name</label>
                                                    <input
                                                        type="text"
                                                        value={formData.company}
                                                        onChange={(e) => setFormData({...formData, company: e.target.value})}
                                                        className="w-full px-4 py-3.5 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:border-cyan-teal focus:ring-2 focus:ring-cyan-teal/30 transition-all backdrop-blur-sm"
                                                        placeholder="Your Company"
                                                    />
                                                </div>
                                                <div className="space-y-2">
                                                    <label className="block text-white/90 mb-2 font-semibold text-sm">
                                                        Service Interest <span className="text-electric-pink">*</span>
                                                    </label>
                                                    <div className="relative">
                                                        <select
                                                            required
                                                            value={formData.service}
                                                            onChange={(e) => setFormData({...formData, service: e.target.value})}
                                                            className="w-full px-4 py-3.5 rounded-xl bg-white/10 border border-white/20 text-white focus:outline-none focus:border-cyan-teal focus:ring-2 focus:ring-cyan-teal/30 transition-all backdrop-blur-sm appearance-none cursor-pointer"
                                                        >
                                                            <option value="" className="bg-dark-slate-2">Select a service</option>
                                                            <option value="AI Opportunity Scan" className="bg-dark-slate-2">AI Opportunity Scan</option>
                                                            <option value="Plug Into Growth Engine" className="bg-dark-slate-2">Plug Into Growth Engine</option>
                                                            <option value="AI Business Engine" className="bg-dark-slate-2">AI Business Engine</option>
                                                            <option value="AI Marketing Engine" className="bg-dark-slate-2">AI Marketing Engine</option>
                                                            <option value="Visibility Stack" className="bg-dark-slate-2">Visibility Stack</option>
                                                            <option value="DFY Services" className="bg-dark-slate-2">DFY Services</option>
                                                            <option value="Other" className="bg-dark-slate-2">Other</option>
                                                        </select>
                                                        <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none">
                                                            <i className="fas fa-chevron-down text-white/60"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div className="space-y-2">
                                                <label className="block text-white/90 mb-2 font-semibold text-sm">
                                                    Message <span className="text-electric-pink">*</span>
                                                </label>
                                                <textarea
                                                    required
                                                    rows="6"
                                                    value={formData.message}
                                                    onChange={(e) => setFormData({...formData, message: e.target.value})}
                                                    className="w-full px-4 py-3.5 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:border-cyan-teal focus:ring-2 focus:ring-cyan-teal/30 transition-all resize-none backdrop-blur-sm"
                                                    placeholder="Tell us about your business, current challenges, and what you'd like to achieve..."
                                                ></textarea>
                                            </div>

                                            <button
                                                type="submit"
                                                className="group relative w-full px-8 py-4 rounded-xl bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal text-white font-bold text-lg hover:scale-[1.02] transition-all duration-300 shadow-2xl shadow-electric-pink/30 overflow-hidden pointer-events-auto mt-8"
                                            >
                                                <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
                                                <span className="relative z-10 flex items-center justify-center gap-2">
                                                    <span>Send Message</span>
                                                    <i className="fas fa-paper-plane"></i>
                                                </span>
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        function FloatingParticles() {
            return (
                <div className="absolute inset-0 overflow-hidden pointer-events-none">
                    {/* Floating geometric shapes */}
                    {[...Array(12)].map((_, i) => (
                        <div
                            key={i}
                            className={`absolute ${i % 2 === 0 ? 'float-animation' : 'float-reverse'}`}
                            style={{
                                left: `${Math.random() * 100}%`,
                                top: `${Math.random() * 100}%`,
                                width: `${20 + Math.random() * 40}px`,
                                height: `${20 + Math.random() * 40}px`,
                                animationDelay: `${i * 0.5}s`,
                                animationDuration: `${15 + Math.random() * 10}s`
                            }}
                        >
                            <div className={`w-full h-full morph-shape ${
                                i % 3 === 0 ? 'bg-gradient-to-br from-electric-pink/20 to-electric-blue/20' :
                                i % 3 === 1 ? 'bg-gradient-to-br from-cyan-teal/20 to-electric-pink/20' :
                                'bg-gradient-to-br from-electric-blue/20 to-cyan-teal/20'
                            } blur-sm`}></div>
                        </div>
                    ))}
                    {/* Floating orbs */}
                    {[...Array(8)].map((_, i) => (
                        <div
                            key={`orb-${i}`}
                            className="absolute pulse-glow"
                            style={{
                                left: `${Math.random() * 100}%`,
                                top: `${Math.random() * 100}%`,
                                width: `${60 + Math.random() * 100}px`,
                                height: `${60 + Math.random() * 100}px`,
                                animationDelay: `${i * 0.8}s`,
                                animationDuration: `${4 + Math.random() * 2}s`
                            }}
                        >
                            <div className={`w-full h-full rounded-full ${
                                i % 3 === 0 ? 'bg-gradient-to-br from-electric-pink/15 to-transparent' :
                                i % 3 === 1 ? 'bg-gradient-to-br from-cyan-teal/15 to-transparent' :
                                'bg-gradient-to-br from-electric-blue/15 to-transparent'
                            } blur-2xl`}></div>
                        </div>
                    ))}
                    {/* Floating lines */}
                    {[...Array(6)].map((_, i) => (
                        <div
                            key={`line-${i}`}
                            className={`absolute ${i % 2 === 0 ? 'float-animation' : 'float-reverse'}`}
                            style={{
                                left: `${Math.random() * 100}%`,
                                top: `${Math.random() * 100}%`,
                                width: `${100 + Math.random() * 200}px`,
                                height: '2px',
                                animationDelay: `${i * 1.2}s`,
                                animationDuration: `${20 + Math.random() * 10}s`,
                                transform: `rotate(${Math.random() * 360}deg)`
                            }}
                        >
                            <div className="w-full h-full bg-gradient-to-r from-transparent via-cyan-teal/30 to-transparent"></div>
                        </div>
                    ))}
                </div>
            );
        }

        function NoScrollJourney() {
            const [journey, setJourney] = useState(null);
            const [currentId, setCurrentId] = useState("");
            const [history, setHistory] = useState([]);
            const [isTransitioning, setIsTransitioning] = useState(false);
            const [prevNode, setPrevNode] = useState(null);

            useEffect(() => {
                fetch("/api/journey")
                    .then(r => r.json())
                    .then((data) => {
                        setJourney(data);
                        setCurrentId(data.start);
                        const params = new URLSearchParams(window.location.search);
                        const step = params.get('step');
                        if (step && data.nodes[step]) {
                            setCurrentId(step);
                        }
                    })
                    .catch(err => {
                        console.error("Failed to load journey:", err);
                        const root = document.getElementById('journey-root');
                        if (root) {
                            root.innerHTML = '<div style="padding: 20px; color: white; background: #020B2E; min-height: 100vh; text-align: center;"><h1>Error Loading Journey</h1><p>Please refresh the page.</p></div>';
                        }
                    });
            }, []);

            const node = useMemo(() => (journey ? journey.nodes[currentId] : null), [journey, currentId]);

            // Handle transitions
            useEffect(() => {
                if (node && prevNode && prevNode !== node) {
                    setIsTransitioning(true);
                    const timer = setTimeout(() => {
                        setIsTransitioning(false);
                    }, 600);
                    return () => clearTimeout(timer);
                }
            }, [node, prevNode]);

            function go(to) {
                if (!journey || !journey.nodes[to] || isTransitioning) return;
                setPrevNode(node);
                setIsTransitioning(true);
                setHistory(prev => [...prev, currentId]);
                
                setTimeout(() => {
                    setCurrentId(to);
                    window.history.replaceState(null, "", `?step=${encodeURIComponent(to)}`);
                    setTimeout(() => {
                        setIsTransitioning(false);
                    }, 50);
                }, 300);
            }

            function back() {
                if (isTransitioning) return;
                setHistory(prev => {
                    if (!prev.length) return prev;
                    const next = prev.slice(0, -1);
                    const last = prev[prev.length - 1];
                    setPrevNode(node);
                    setIsTransitioning(true);
                    
                    setTimeout(() => {
                        setCurrentId(last);
                        window.history.replaceState(null, "", `?step=${encodeURIComponent(last)}`);
                        setTimeout(() => {
                            setIsTransitioning(false);
                        }, 50);
                    }, 300);
                    return next;
                });
            }

            function home() {
                if (!journey || isTransitioning) return;
                setPrevNode(node);
                setIsTransitioning(true);
                setHistory([]);
                
                setTimeout(() => {
                    setCurrentId(journey.start);
                    window.history.replaceState(null, "", `?step=${encodeURIComponent(journey.start)}`);
                    setTimeout(() => {
                        setIsTransitioning(false);
                    }, 50);
                }, 300);
            }

            if (!node) {
                return (
                    <div className="h-screen w-full grid place-items-center bg-deep-navy text-white">
                        <div className="text-sm opacity-70">Loading journeyâ€¦</div>
                    </div>
                );
            }

            // Error boundary - if design variant doesn't exist, use default
            let designVariant = node.design;
            if (!designVariant) {
                if (currentId.includes('hero')) designVariant = 'hero-premium';
                else if (currentId.includes('module') && currentId.startsWith('business_engine_module_')) designVariant = 'module-game';
                else if (currentId.includes('module')) designVariant = 'module-card';
                else if (currentId.includes('comparison')) designVariant = 'comparison-table';
                else if (currentId.includes('metrics') || currentId.includes('impact')) designVariant = 'metrics-grid';
                else if (currentId.includes('testimonial')) designVariant = 'testimonial-split';
                else if (currentId.includes('guarantee') || currentId.includes('risk')) designVariant = 'badge-premium';
                else if (currentId.includes('cta') || currentId.includes('contact')) designVariant = 'cta-gradient';
                else if (currentId.includes('about') || currentId.includes('leadership')) designVariant = 'about-split';
                else if (currentId.includes('layer') || currentId.includes('visibility')) designVariant = 'layered-premium';
                else if (currentId.includes('service') || currentId.includes('dfy')) designVariant = 'service-elegant';
                else if (currentId.includes('engine_overview') || currentId.includes('overview')) designVariant = 'stack-showcase';
                else if (currentId === 'business_engine_problem' || currentId.includes('fragmentation')) designVariant = 'problem-premium';
                else if (currentId.includes('at_glance') || currentId.includes('co-pilots')) designVariant = 'co-pilots-network';
                else if (currentId.includes('dfy_process') || (currentId.includes('process') && !currentId.includes('service'))) designVariant = 'process-steps';
                else designVariant = 'statement-premium';
            }

            function getIconClass(iconName) {
                const iconMap = {
                    'bolt': 'fa-bolt', 'robot': 'fa-robot', 'chart': 'fa-chart-line',
                    'users': 'fa-users', 'rocket': 'fa-rocket', 'brain': 'fa-brain'
                };
                return iconMap[iconName] || 'fa-circle';
            }

            // Render different designs based on variant
            function renderDesign() {
                switch(designVariant) {
                    case 'hero-premium':
                        return renderHeroPremium();
                    case 'hero-split':
                        return renderHeroSplit();
                    case 'module-card':
                        return renderModuleCard();
                    case 'module-game':
                        return renderModuleGame();
                    case 'comparison-table':
                        return renderComparisonTable();
                    case 'metrics-grid':
                        return renderMetricsGrid();
                    case 'testimonial-split':
                        return renderTestimonialSplit();
                    case 'badge-premium':
                        return renderBadgePremium();
                    case 'cta-gradient':
                        return renderCTAGradient();
                    case 'about-split':
                        return renderAboutSplit();
                    case 'layered-premium':
                        return renderLayeredPremium();
                    case 'service-elegant':
                        return renderServiceElegant();
                    case 'contact-options':
                        return renderContactOptions();
                case 'contact-form-premium':
                    return renderContactForm();
                case 'stack-showcase':
                    return renderStackShowcase();
                case 'problem-premium':
                    return renderProblemPremium();
                case 'co-pilots-network':
                    return renderCoPilotsNetwork();
                case 'process-steps':
                    return renderProcessSteps();
                case 'statement-premium':
                default:
                    return renderStatementPremium();
            }
        }

            function renderHeroPremium() {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center">
                        <div className="max-w-5xl mx-auto px-6 w-full">
                            {node.eyebrow && (
                                <div className="text-xs tracking-[0.4em] uppercase opacity-50 mb-6 font-light">
                                    {node.eyebrow}
                                </div>
                            )}
                            <h1 className="text-6xl md:text-8xl font-bold leading-[0.95] mb-6 bg-gradient-to-r from-white via-cyan-teal to-electric-pink bg-clip-text text-transparent">
                                {node.title}
                            </h1>
                            {node.subtitle && (
                                <div className="text-2xl md:text-3xl text-cyan-teal mb-8 font-light">
                                    {node.subtitle}
                                </div>
                            )}
                            {node.body && (
                                <p className="text-lg md:text-xl text-white/70 mb-12 max-w-2xl leading-relaxed">
                                    {node.body}
                                </p>
                            )}
                            <div className="flex flex-col sm:flex-row gap-4">
                                {node.choices?.map((c, idx) => (
                                    <button
                                        key={idx}
                                        onClick={() => go(c.to)}
                                        className={`px-8 py-5 rounded-2xl font-semibold text-lg transition-all transform hover:scale-105 ${
                                            idx === 0 
                                                ? 'bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal text-white shadow-2xl shadow-electric-pink/30'
                                                : 'bg-white/10 backdrop-blur-md text-white border border-white/20 hover:bg-white/20'
                                        }`}
                                    >
                                        {c.label}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            function renderHeroSplit() {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center">
                        <div className="max-w-7xl mx-auto px-6 w-full">
                            <div className="grid md:grid-cols-2 gap-12 lg:gap-16 items-center">
                                {/* Left Content Section */}
                                <div className="space-y-8">
                                    {node.eyebrow && (
                                        <div className="inline-block px-4 py-2 rounded-full bg-gradient-to-r from-electric-pink/20 to-electric-blue/20 border border-electric-pink/30 mb-2">
                                            <span className="text-xs tracking-[0.3em] uppercase text-cyan-teal font-semibold">{node.eyebrow}</span>
                                        </div>
                                    )}
                                    <h1 className="text-3xl md:text-4xl lg:text-5xl font-bold leading-[1.1] mb-6 text-balance">
                                        <span className="bg-gradient-to-r from-white via-cyan-teal to-electric-pink bg-clip-text text-transparent">
                                            {node.title?.replace(/\s+(\w+)\s*\./g, '\u00A0$1.').replace(/\s+(\w+)$/g, '\u00A0$1') || node.title}
                                        </span>
                                    </h1>
                                    {node.subtitle && (
                                        <div className="text-base md:text-lg text-cyan-teal mb-6 font-light leading-relaxed">
                                            {node.subtitle}
                                        </div>
                                    )}
                                    {node.body && (
                                        <p className="text-lg md:text-xl text-white/80 leading-relaxed max-w-xl">
                                            {node.body}
                                        </p>
                                    )}
                                </div>

                                {/* Right Interactive Panel */}
                                <div className="relative">
                                    {/* Animated glow effects */}
                                    <div className="absolute -inset-4 bg-gradient-to-br from-electric-pink/30 via-electric-blue/30 to-cyan-teal/30 rounded-3xl blur-2xl opacity-60 animate-pulse"></div>
                                    <div className="absolute -inset-2 bg-gradient-to-br from-electric-pink/20 to-electric-blue/20 rounded-3xl blur-xl opacity-40"></div>
                                    
                                    {/* Panel Container */}
                                    <div className="relative bg-gradient-to-br from-dark-slate-2/90 via-deep-navy/90 to-dark-slate-2/90 backdrop-blur-2xl rounded-3xl p-8 md:p-10 border border-white/20 shadow-2xl overflow-hidden">
                                        {/* Animated background gradient */}
                                        <div className="absolute inset-0 bg-gradient-to-br from-electric-pink/5 via-electric-blue/5 to-cyan-teal/5 opacity-50"></div>
                                        <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal"></div>
                                        
                                        {/* Buttons Container */}
                                        <div className="relative z-10 space-y-4">
                                            {node.choices?.map((c, idx) => (
                                                <button
                                                    key={idx}
                                                    onClick={(e) => {
                                                        e.preventDefault();
                                                        e.stopPropagation();
                                                        go(c.to);
                                                    }}
                                                    className="group relative w-full px-8 py-5 rounded-2xl font-bold text-lg text-white overflow-hidden transform transition-all duration-300 hover:scale-[1.02] hover:shadow-2xl pointer-events-auto"
                                                    style={{
                                                        background: idx === 0 
                                                            ? 'linear-gradient(135deg, #ff007a 0%, #00e0ff 50%, #00d4ff 100%)'
                                                            : idx === 1
                                                            ? 'linear-gradient(135deg, #ff007a 0%, #00a8ff 100%)'
                                                            : 'linear-gradient(135deg, #00a8ff 0%, #00d4ff 100%)'
                                                    }}
                                                >
                                                    {/* Shine effect */}
                                                    <div className="absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"></div>
                                                    
                                                    {/* Button content */}
                                                    <span className="relative z-10 flex items-center justify-center">
                                                        {c.label}
                                                        <i className="fas fa-arrow-right ml-3 transform group-hover:translate-x-2 transition-transform duration-300"></i>
                                                    </span>
                                                    
                                                    {/* Hover glow */}
                                                    <div className="absolute inset-0 bg-gradient-to-r from-white/0 via-white/10 to-white/0 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                                                </button>
                                            ))}
                                        </div>
                                        
                                        {/* Decorative corner accents */}
                                        <div className="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-electric-pink/10 to-transparent rounded-bl-full"></div>
                                        <div className="absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-tr from-cyan-teal/10 to-transparent rounded-tr-full"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            function ModuleGameComponent({ node, journey, go }) {
                // Define all modules
                const allModules = [
                    {
                        id: 'business_engine_module_a',
                        letter: 'A',
                        name: 'The Executive Assistant',
                        icon: 'fa-user-tie',
                        gradient: 'from-electric-pink via-electric-blue to-cyan-teal',
                        position: 'center'
                    },
                    {
                        id: 'business_engine_module_b',
                        letter: 'B',
                        name: 'The Business Consultant',
                        icon: 'fa-chart-line',
                        gradient: 'from-cyan-teal to-electric-blue',
                        position: 'top-right'
                    },
                    {
                        id: 'business_engine_module_c',
                        letter: 'C',
                        name: 'The Team Assistant & Onboarding Engine',
                        icon: 'fa-rocket',
                        gradient: 'from-electric-blue to-cyan-teal',
                        position: 'bottom-right'
                    },
                    {
                        id: 'business_engine_module_d',
                        letter: 'D',
                        name: 'The Team Coordinator',
                        icon: 'fa-users',
                        gradient: 'from-warm-yellow to-electric-pink',
                        position: 'bottom-left'
                    },
                    {
                        id: 'business_engine_module_e',
                        letter: 'E',
                        name: 'The Sales Engine',
                        icon: 'fa-bullhorn',
                        gradient: 'from-electric-pink to-warm-yellow',
                        position: 'top-left'
                    }
                ];

                // Find current module
                const currentModuleId = node && journey?.nodes ? Object.keys(journey.nodes).find(id => 
                    id.startsWith('business_engine_module_') && journey.nodes[id]?.title === node.title
                ) : 'business_engine_module_a';

                const [activeModuleId, setActiveModuleId] = useState(currentModuleId || 'business_engine_module_a');
                const [activeTab, setActiveTab] = useState('Overview');

                // Get active module data
                const activeModule = allModules.find(m => m.id === activeModuleId) || allModules[0];
                const activeModuleData = (journey?.nodes?.[activeModuleId]) || node || {};
                let surroundingModules = allModules.filter(m => m.id !== activeModuleId && m.id);

                // Dynamically assign positions to surrounding modules
                // Create a position map: when a module is active, assign others to available positions
                const positionMap = {
                    'business_engine_module_a': {
                        'business_engine_module_b': 'top-right',
                        'business_engine_module_c': 'bottom-right',
                        'business_engine_module_d': 'bottom-left',
                        'business_engine_module_e': 'top-left'
                    },
                    'business_engine_module_b': {
                        'business_engine_module_a': 'top-left',
                        'business_engine_module_c': 'bottom-right',
                        'business_engine_module_d': 'bottom-left',
                        'business_engine_module_e': 'top-right'
                    },
                    'business_engine_module_c': {
                        'business_engine_module_a': 'top-left',
                        'business_engine_module_b': 'top-right',
                        'business_engine_module_d': 'bottom-left',
                        'business_engine_module_e': 'bottom-right'
                    },
                    'business_engine_module_d': {
                        'business_engine_module_a': 'top-left',
                        'business_engine_module_b': 'top-right',
                        'business_engine_module_c': 'bottom-right',
                        'business_engine_module_e': 'bottom-left'
                    },
                    'business_engine_module_e': {
                        'business_engine_module_a': 'top-right',
                        'business_engine_module_b': 'bottom-right',
                        'business_engine_module_c': 'bottom-left',
                        'business_engine_module_d': 'top-left'
                    }
                };

                const currentPositionMap = positionMap[activeModuleId] || {};
                surroundingModules = surroundingModules.map((module) => ({
                    ...module,
                    position: currentPositionMap[module.id] || (module.position === 'center' ? 'top-left' : module.position)
                }));

                // Safety check - don't render if no module data
                if (!activeModule || !activeModuleData) {
                    return (
                        <div className="relative z-10 h-[calc(100vh-84px)] flex items-center justify-center">
                            <div className="text-white">Loading module...</div>
                        </div>
                    );
                }

                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center overflow-hidden py-8">
                        <div className="max-w-7xl mx-auto px-6 w-full h-full flex flex-col">
                            {/* Header */}
                            <div className="text-center mb-6">
                                <h1 className="text-4xl md:text-5xl font-bold mb-2">
                                    <span className="bg-gradient-to-r from-white via-cyan-teal to-electric-pink bg-clip-text text-transparent">
                                        The Five Co-Pilots
                                    </span>
                                </h1>
                                <div className="text-xl md:text-2xl text-cyan-teal font-light">
                                    Module by Module
                                </div>
                            </div>

                            {/* Network Layout */}
                            <div className="flex-1 relative flex items-center justify-center">
                                {/* Connecting Lines */}
                                <svg className="absolute inset-0 w-full h-full pointer-events-none z-10">
                                    {surroundingModules.map((module, idx) => {
                                        const positions = {
                                            'top-left': { x: '20%', y: '20%' },
                                            'top-right': { x: '80%', y: '20%' },
                                            'bottom-left': { x: '20%', y: '80%' },
                                            'bottom-right': { x: '80%', y: '80%' }
                                        };
                                        const pos = positions[module.position] || { x: '50%', y: '50%' };
                                        if (!pos || !pos.x || !pos.y) return null;
                                        return (
                                            <line
                                                key={idx}
                                                x1="50%"
                                                y1="50%"
                                                x2={pos.x}
                                                y2={pos.y}
                                                stroke="url(#moduleGradient)"
                                                strokeWidth="2"
                                                opacity="0.4"
                                                className="animate-pulse"
                                            />
                                        );
                                    })}
                                    <defs>
                                        <linearGradient id="moduleGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" stopColor="#ff007a" stopOpacity="0.6" />
                                            <stop offset="50%" stopColor="#00a8ff" stopOpacity="0.6" />
                                            <stop offset="100%" stopColor="#00d4ff" stopOpacity="0.6" />
                                        </linearGradient>
                                    </defs>
                                </svg>

                                {/* Surrounding Modules (Smaller Cards) */}
                                {surroundingModules.map((module, idx) => {
                                    if (!module || !module.position) return null;
                                    const positions = {
                                        'top-left': 'absolute top-0 left-0',
                                        'top-right': 'absolute top-0 right-0',
                                        'bottom-left': 'absolute bottom-0 left-0',
                                        'bottom-right': 'absolute bottom-0 right-0'
                                    };
                                    const positionClass = positions[module.position] || 'absolute top-0 left-0';
                                    const moduleData = journey?.nodes?.[module.id];
                                    return (
                                        <div
                                            key={module.id || idx}
                                            onClick={() => setActiveModuleId(module.id)}
                                            className={`${positionClass} w-48 h-32 cursor-pointer transform hover:scale-110 transition-all duration-300 group z-20`}
                                        >
                                            <div className="relative bg-gradient-to-br from-dark-slate-2/90 to-deep-navy/90 backdrop-blur-xl rounded-2xl p-4 border border-white/20 h-full hover:border-white/40 transition-all shadow-xl">
                                                <div className={`absolute -inset-1 bg-gradient-to-r ${module.gradient || 'from-electric-pink to-electric-blue'} rounded-2xl blur opacity-0 group-hover:opacity-60 transition-opacity`}></div>
                                                <div className="relative z-10 h-full flex flex-col">
                                                    <div className={`inline-flex items-center justify-center w-10 h-10 rounded-full bg-gradient-to-r ${module.gradient || 'from-electric-pink to-electric-blue'} mb-2`}>
                                                        <i className={`fas ${module.icon || 'fa-circle'} text-white text-lg`}></i>
                                                    </div>
                                                    <div className="text-white font-bold text-sm mb-1">{module.letter || '?'}</div>
                                                    <div className="text-white/80 text-xs leading-tight">{module.name || 'Module'}</div>
                                                </div>
                                            </div>
                                        </div>
                                    );
                                })}

                                {/* Central Module Card (Large) */}
                                <div className="relative w-full max-w-2xl mx-auto z-30">
                                    <div className="relative bg-gradient-to-br from-dark-slate-2/98 via-deep-navy/98 to-dark-slate-2/98 backdrop-blur-2xl rounded-3xl p-8 md:p-10 border border-white/30 shadow-2xl overflow-hidden">
                                        {/* Glow effects */}
                                        <div className="absolute -inset-4 bg-gradient-to-r from-electric-pink/30 via-electric-blue/30 to-cyan-teal/30 rounded-3xl blur-2xl opacity-60 animate-pulse"></div>
                                        
                                        {/* Top accent line */}
                                        <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal"></div>

                                        {/* Module Badge */}
                                        <div className="flex items-center gap-4 mb-6">
                                            <div className={`w-16 h-16 rounded-full bg-gradient-to-r ${activeModule.gradient} flex items-center justify-center shadow-2xl`}>
                                                <span className="text-white text-2xl font-bold">{activeModule.letter}</span>
                                            </div>
                                            <h2 className="text-2xl md:text-3xl lg:text-4xl font-bold text-white leading-tight">{activeModuleData?.title?.replace(/^Module [A-E]:\s*/, '') || activeModule.name}</h2>
                                        </div>

                                        {/* Tabs */}
                                        <div className="flex gap-2 mb-6 border-b border-white/10 relative z-20">
                                            {['Overview', 'Detail', 'All points'].map((tab) => (
                                                <button
                                                    key={tab}
                                                    onClick={(e) => {
                                                        e.preventDefault();
                                                        e.stopPropagation();
                                                        setActiveTab(tab);
                                                    }}
                                                    className={`px-4 py-2 text-sm font-semibold transition-all cursor-pointer pointer-events-auto relative z-20 ${
                                                        activeTab === tab
                                                            ? 'text-cyan-teal border-b-2 border-cyan-teal'
                                                            : 'text-white/60 hover:text-white/80'
                                                    }`}
                                                >
                                                    {tab}
                                                </button>
                                            ))}
                                        </div>

                                        {/* Content based on active tab */}
                                        <div className="mb-6 min-h-[180px] relative z-10">
                                            {activeTab === 'Overview' && (
                                                <div className="space-y-4">
                                                    <p className="text-white text-lg md:text-xl leading-relaxed">{activeModuleData?.body?.split('.')[0] || activeModuleData?.body || 'Founders report gaining back an entire workday every week.'}</p>
                                                    {activeModuleData?.subtitle && (
                                                        <div className="px-6 py-4 rounded-2xl bg-gradient-to-r from-electric-pink/20 to-cyan-teal/20 border border-cyan-teal/30 backdrop-blur-sm">
                                                            <p className="text-cyan-teal font-bold text-xl md:text-2xl">{activeModuleData.subtitle}</p>
                                                        </div>
                                                    )}
                                                </div>
                                            )}
                                            {activeTab === 'Detail' && (
                                                <div>
                                                    <p className="text-white text-base md:text-lg leading-relaxed">{activeModuleData?.body || 'No details available.'}</p>
                                                </div>
                                            )}
                                            {activeTab === 'All points' && (
                                                <div>
                                                    <p className="text-white text-base md:text-lg leading-relaxed whitespace-pre-line">{activeModuleData?.body || 'No additional points available.'}</p>
                                                </div>
                                            )}
                                        </div>

                                        {/* Navigation */}
                                        <div className="flex items-center justify-between text-white/80 text-base font-medium">
                                            <button 
                                                onClick={() => {
                                                    const currentIdx = allModules.findIndex(m => m.id === activeModuleId);
                                                    const prevIdx = currentIdx > 0 ? currentIdx - 1 : allModules.length - 1;
                                                    setActiveModuleId(allModules[prevIdx].id);
                                                }}
                                                className="hover:text-white transition-colors cursor-pointer"
                                            >
                                                â† Previous
                                            </button>
                                            <span className="text-white font-semibold">{allModules.findIndex(m => m.id === activeModuleId) + 1} / {allModules.length}</span>
                                            <button 
                                                onClick={() => {
                                                    const currentIdx = allModules.findIndex(m => m.id === activeModuleId);
                                                    const nextIdx = currentIdx < allModules.length - 1 ? currentIdx + 1 : 0;
                                                    setActiveModuleId(allModules[nextIdx].id);
                                                }}
                                                className="hover:text-white transition-colors cursor-pointer"
                                            >
                                                Next â†’
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* Bottom CTA Buttons */}
                            <div className="flex flex-col sm:flex-row gap-4 justify-center mt-6">
                                {node.choices?.slice(0, 2).map((c, idx) => (
                                    <button
                                        key={idx}
                                        onClick={(e) => {
                                            e.preventDefault();
                                            e.stopPropagation();
                                            go(c.to);
                                        }}
                                        className="group relative px-8 py-5 rounded-2xl font-bold text-lg transition-all duration-300 transform hover:scale-105 hover:shadow-2xl overflow-hidden pointer-events-auto bg-gradient-to-br from-dark-slate-2/90 to-deep-navy/90 backdrop-blur-xl border-2 border-white/20 hover:border-cyan-teal/50 text-white"
                                    >
                                        <div className="absolute inset-0 bg-gradient-to-r from-electric-pink/20 via-electric-blue/20 to-cyan-teal/20 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                                        <span className="relative z-10">{c.label}</span>
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            function renderModuleGame() {
                return <ModuleGameComponent node={node} journey={journey} go={go} />;
            }

            function renderModuleCard() {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center py-12">
                        <div className="max-w-5xl mx-auto px-6 w-full">
                            {/* Outer glow effects */}
                            <div className="absolute -inset-8 bg-gradient-to-r from-electric-pink/20 via-electric-blue/20 to-cyan-teal/20 rounded-3xl blur-3xl opacity-60 animate-pulse"></div>
                            <div className="absolute -inset-4 bg-gradient-to-r from-electric-pink/10 to-cyan-teal/10 rounded-3xl blur-2xl"></div>
                            
                            {/* Main Card */}
                            <div className="relative bg-gradient-to-br from-dark-slate-2/95 via-deep-navy/95 to-dark-slate-2/95 backdrop-blur-2xl rounded-3xl p-8 md:p-12 border border-white/20 shadow-2xl overflow-hidden">
                                {/* Animated background gradients */}
                                <div className="absolute inset-0 bg-gradient-to-br from-electric-pink/5 via-electric-blue/5 to-cyan-teal/5 opacity-50"></div>
                                <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal"></div>
                                
                                {/* Content */}
                                <div className="relative z-10">
                                    {/* Eyebrow badge */}
                                    <div className="inline-block px-4 py-2 rounded-full bg-gradient-to-r from-electric-pink/20 to-electric-blue/20 border border-electric-pink/30 mb-6">
                                        <span className="text-xs tracking-[0.3em] uppercase text-cyan-teal font-semibold">{node.eyebrow || 'MODULE'}</span>
                                    </div>

                                    {/* Title with gradient */}
                                    <h1 className="text-4xl md:text-5xl lg:text-6xl font-bold mb-6 leading-tight">
                                        <span className="bg-gradient-to-r from-white via-cyan-teal to-electric-pink bg-clip-text text-transparent">
                                            {node.title}
                                        </span>
                                    </h1>

                                    {/* Subtitle with highlight */}
                                    {node.subtitle && (
                                        <div className="relative mb-8">
                                            <div className="inline-block px-6 py-3 rounded-2xl bg-gradient-to-r from-cyan-teal/20 to-electric-blue/20 border border-cyan-teal/30 backdrop-blur-sm">
                                                <span className="text-xl md:text-2xl text-cyan-teal font-semibold">
                                                    {node.subtitle}
                                                </span>
                                            </div>
                                        </div>
                                    )}

                                    {/* Body text with enhanced styling */}
                                    {node.body && (
                                        <div className="relative mb-10">
                                            <div className="absolute -left-4 top-0 bottom-0 w-1 bg-gradient-to-b from-electric-pink via-electric-blue to-cyan-teal rounded-full"></div>
                                            <p className="text-base md:text-lg lg:text-xl text-white/90 leading-relaxed pl-8 max-w-4xl">
                                                {node.body}
                                            </p>
                                        </div>
                                    )}

                                    {/* Buttons with premium styling */}
                                    <div className="flex flex-col sm:flex-row gap-5 mt-12">
                                        {node.choices?.map((c, idx) => (
                                            <button
                                                key={idx}
                                                onClick={(e) => {
                                                    e.preventDefault();
                                                    e.stopPropagation();
                                                    go(c.to);
                                                }}
                                                className={`group relative px-8 py-5 rounded-2xl font-bold text-base md:text-lg transition-all duration-500 transform hover:scale-[1.05] hover:shadow-2xl overflow-hidden pointer-events-auto ${
                                                    idx === 0 
                                                        ? 'sm:flex-1 min-w-[200px]'
                                                        : idx === 1
                                                        ? 'sm:flex-1 min-w-[200px]'
                                                        : 'sm:w-full min-w-[200px]'
                                                }`}
                                                style={
                                                    idx === 0
                                                        ? {
                                                            background: 'linear-gradient(135deg, #ff007a 0%, #00a8ff 50%, #00d4ff 100%)',
                                                            color: 'white',
                                                            boxShadow: '0 10px 40px rgba(255, 0, 122, 0.3)'
                                                        }
                                                        : idx === 1
                                                        ? {
                                                            background: 'rgba(255, 255, 255, 0.08)',
                                                            color: 'white',
                                                            border: '2px solid rgba(255, 255, 255, 0.25)',
                                                            backdropFilter: 'blur(12px)',
                                                            boxShadow: '0 8px 32px rgba(0, 0, 0, 0.3)'
                                                        }
                                                        : {
                                                            background: 'linear-gradient(135deg, rgba(0, 168, 255, 0.15) 0%, rgba(0, 212, 255, 0.15) 100%)',
                                                            color: 'white',
                                                            border: '2px solid rgba(0, 212, 255, 0.4)',
                                                            backdropFilter: 'blur(12px)',
                                                            boxShadow: '0 8px 32px rgba(0, 168, 255, 0.2)'
                                                        }
                                                }
                                            >
                                                {/* Outer glow effect */}
                                                <div className={`absolute -inset-1 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 blur-lg ${
                                                    idx === 0 
                                                        ? 'bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal'
                                                        : idx === 1
                                                        ? 'bg-white/20'
                                                        : 'bg-cyan-teal/30'
                                                }`}></div>
                                                
                                                {/* Animated background gradient for primary */}
                                                {idx === 0 && (
                                                    <div className="absolute inset-0 bg-gradient-to-r from-electric-pink/0 via-white/20 to-cyan-teal/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                                                )}
                                                
                                                {/* Shine sweep effect */}
                                                <div className={`absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/40 to-transparent ${
                                                    idx === 0 ? '' : 'via-white/20'
                                                }`}></div>
                                                
                                                {/* Pulsing glow for primary button */}
                                                {idx === 0 && (
                                                    <div className="absolute inset-0 rounded-2xl bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal opacity-20 animate-pulse"></div>
                                                )}
                                                
                                                {/* Hover gradient overlay for secondary buttons */}
                                                {(idx === 1 || idx === 2) && (
                                                    <>
                                                        <div className="absolute inset-0 bg-gradient-to-r from-white/0 via-white/15 to-white/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                                                        <div className={`absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 ${
                                                            idx === 1 
                                                                ? 'bg-gradient-to-r from-white/10 to-white/5'
                                                                : 'bg-gradient-to-r from-cyan-teal/20 to-electric-blue/20'
                                                        }`}></div>
                                                    </>
                                                )}
                                                
                                                {/* Button content */}
                                                <span className="relative z-10 flex items-center justify-center font-semibold tracking-wide">
                                                    {c.label}
                                                    {idx === 0 && (
                                                        <i className="fas fa-arrow-right ml-3 transform group-hover:translate-x-3 transition-transform duration-300"></i>
                                                    )}
                                                    {(idx === 1 || idx === 2) && (
                                                        <i className="fas fa-chevron-right ml-2 text-sm transform group-hover:translate-x-1 transition-transform duration-300"></i>
                                                    )}
                                                </span>
                                                
                                                {/* Animated border glow for all buttons */}
                                                <div className={`absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 -z-10 ${
                                                    idx === 0 
                                                        ? 'bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal blur-sm'
                                                        : idx === 1
                                                        ? 'bg-white/30 blur-sm'
                                                        : 'bg-cyan-teal/50 blur-sm'
                                                }`}></div>
                                                
                                                {/* Ripple effect on click */}
                                                <div className="absolute inset-0 rounded-2xl bg-white/20 scale-0 group-active:scale-100 opacity-0 group-active:opacity-100 transition-all duration-300"></div>
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                {/* Decorative corner accents */}
                                <div className="absolute top-0 right-0 w-40 h-40 bg-gradient-to-br from-electric-pink/10 to-transparent rounded-bl-full"></div>
                                <div className="absolute bottom-0 left-0 w-40 h-40 bg-gradient-to-tr from-cyan-teal/10 to-transparent rounded-tr-full"></div>
                                
                                {/* Animated shine effect */}
                                <div className="absolute inset-0 -translate-x-full hover:translate-x-full transition-transform duration-2000 bg-gradient-to-r from-transparent via-white/5 to-transparent pointer-events-none"></div>
                            </div>
                        </div>
                    </div>
                );
            }

            function renderComparisonTable() {
                // Parse comparison data from body
                const parseComparison = (body) => {
                    if (!body) return [];
                    const comparisons = [];
                    const lines = body.split('. ').filter(l => l.trim());
                    
                    lines.forEach(line => {
                        const parts = line.split(': ');
                        if (parts.length === 2) {
                            const category = parts[0].trim();
                            const values = parts[1].split(', ').map(v => v.trim());
                            if (values.length >= 3) {
                                comparisons.push({
                                    category,
                                    agency: values[0] || '',
                                    inHouse: values[1] || '',
                                    aiEngine: values[2] || ''
                                });
                            }
                        }
                    });
                    
                    return comparisons;
                };

                const comparisons = parseComparison(node.body);

                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center overflow-y-auto py-12">
                        <div className="max-w-6xl mx-auto px-6 w-full">
                            {/* Header */}
                            <div className="text-center mb-10">
                                <h1 className="text-4xl md:text-5xl lg:text-6xl font-bold mb-4 text-white">
                                    {node.title}
                                </h1>
                                {node.subtitle && (
                                    <div className="text-lg md:text-xl text-cyan-teal font-light">
                                        {node.subtitle}
                                    </div>
                                )}
                            </div>

                            {/* Comparison Card */}
                            <div className="relative">
                                {/* Glow effect */}
                                <div className="absolute -inset-2 bg-gradient-to-r from-electric-pink/30 via-electric-blue/30 to-cyan-teal/30 rounded-3xl blur-2xl opacity-50"></div>
                                
                                {/* Main card */}
                                <div className="relative bg-gradient-to-br from-dark-slate-2/95 via-dark-slate-2/90 to-deep-navy/95 backdrop-blur-2xl rounded-3xl p-8 md:p-10 border border-white/20 shadow-2xl">
                                    {/* Top accent line */}
                                    <div className="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal rounded-t-3xl"></div>

                                    {/* Table Header */}
                                    <div className="grid grid-cols-4 gap-4 md:gap-6 mb-6 pb-6 border-b border-white/10">
                                        <div className="text-left">
                                            <h3 className="text-sm md:text-base font-semibold text-white/60 uppercase tracking-wider"></h3>
                                        </div>
                                        <div className="text-center">
                                            <h3 className="text-lg font-semibold text-white/90">Agency</h3>
                                        </div>
                                        <div className="text-center">
                                            <h3 className="text-lg font-semibold text-white/90">In-House</h3>
                                        </div>
                                        <div className="text-center relative">
                                            <h3 className="text-lg font-semibold text-white">AI Engine</h3>
                                            {/* Highlight underline */}
                                            <div className="absolute bottom-[-24px] left-1/2 -translate-x-1/2 w-20 h-1 bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal rounded-full"></div>
                                        </div>
                                    </div>

                                    {/* Comparison Rows */}
                                    <div className="space-y-6 mb-10">
                                        {comparisons.map((comp, idx) => (
                                            <div key={idx} className="grid grid-cols-4 gap-4 md:gap-6 py-4 border-b border-white/5 last:border-0">
                                                <div className="text-white/80 font-medium text-sm md:text-base">
                                                    {comp.category}
                                                </div>
                                                <div className="text-white/70 text-sm md:text-base text-center">
                                                    {comp.agency}
                                                </div>
                                                <div className="text-white/70 text-sm md:text-base text-center">
                                                    {comp.inHouse}
                                                </div>
                                                <div className="text-cyan-teal font-semibold text-sm md:text-base text-center">
                                                    {comp.aiEngine}
                                                </div>
                                            </div>
                                        ))}
                                    </div>

                                    {/* CTA Buttons */}
                                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                        {node.choices?.map((c, idx) => (
                                            <button
                                                key={idx}
                                                onClick={(e) => {
                                                    e.preventDefault();
                                                    e.stopPropagation();
                                                    go(c.to);
                                                }}
                                                className={`group relative px-6 py-4 rounded-xl font-bold text-base md:text-lg transition-all duration-300 transform hover:scale-[1.02] hover:shadow-xl overflow-hidden pointer-events-auto ${
                                                    idx === 0 || idx === 1
                                                        ? 'bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal text-white'
                                                        : 'bg-white/10 hover:bg-white/15 border border-white/20 text-white backdrop-blur-sm'
                                                }`}
                                            >
                                                {(idx === 0 || idx === 1) && (
                                                    <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
                                                )}
                                                <span className="relative z-10">{c.label}</span>
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            function renderMetricsGrid() {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center">
                        <div className="max-w-6xl mx-auto px-6 w-full">
                            <h1 className="text-4xl md:text-6xl font-bold mb-4 text-center">{node.title}</h1>
                            {node.subtitle && (
                                <div className="text-xl text-cyan-teal mb-12 text-center">{node.subtitle}</div>
                            )}
                            <div className="grid md:grid-cols-3 gap-6 mb-12">
                                {node.body.split('.').filter(p => p.trim()).slice(0, 6).map((metric, idx) => (
                                    <div key={idx} className="bg-gradient-to-br from-electric-pink/10 to-electric-blue/10 backdrop-blur-xl rounded-2xl p-6 border border-white/10">
                                        <div className="text-3xl font-bold text-electric-pink mb-2">{metric.split(' ')[0]}</div>
                                        <div className="text-white/80 text-sm">{metric.substring(metric.indexOf(' ') + 1)}</div>
                                    </div>
                                ))}
                            </div>
                            <div className="flex flex-col sm:flex-row gap-4 justify-center">
                                {node.choices?.map((c, idx) => (
                                    <button
                                        key={idx}
                                        onClick={() => go(c.to)}
                                        className="px-8 py-4 rounded-xl bg-gradient-to-r from-electric-pink to-electric-blue text-white font-semibold hover:scale-105 transition-transform"
                                    >
                                        {c.label}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            function renderTestimonialSplit() {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] grid md:grid-cols-2 items-center gap-12">
                        <div>
                            <h1 className="text-4xl md:text-5xl font-bold mb-6">{node.title}</h1>
                            {node.subtitle && (
                                <div className="text-xl text-cyan-teal mb-6">{node.subtitle}</div>
                            )}
                            <div className="flex gap-4">
                                {node.choices?.map((c, idx) => (
                                    <button
                                        key={idx}
                                        onClick={() => go(c.to)}
                                        className="px-6 py-3 rounded-xl bg-white/10 hover:bg-white/20 text-white font-medium transition-all"
                                    >
                                        {c.label}
                                    </button>
                                ))}
                            </div>
                        </div>
                        <div className="bg-gradient-to-br from-electric-pink/10 to-electric-blue/10 backdrop-blur-xl rounded-3xl p-8 border border-white/10">
                            {node.body && (
                                <div className="text-white/90 text-lg leading-relaxed italic mb-4">
                                    "{node.body.split('â€”')[0]}"
                                </div>
                            )}
                            {node.body && node.body.includes('â€”') && (
                                <div className="text-cyan-teal font-semibold">
                                    â€” {node.body.split('â€”')[1]}
                                </div>
                            )}
                        </div>
                    </div>
                );
            }

            function renderBadgePremium() {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center">
                        <div className="max-w-3xl mx-auto px-6 w-full text-center">
                            <div className="inline-block px-6 py-3 rounded-full bg-gradient-to-r from-electric-pink to-electric-blue text-white text-sm font-semibold mb-8">
                                GUARANTEE
                            </div>
                            <h1 className="text-5xl md:text-7xl font-bold mb-6">{node.title}</h1>
                            {node.subtitle && (
                                <div className="text-2xl text-cyan-teal mb-8">{node.subtitle}</div>
                            )}
                            {node.body && (
                                <p className="text-xl text-white/80 mb-12 leading-relaxed max-w-2xl mx-auto">
                                    {node.body}
                                </p>
                            )}
                            <div className="flex flex-col sm:flex-row gap-4 justify-center">
                                {node.choices?.map((c, idx) => (
                                    <button
                                        key={idx}
                                        onClick={() => go(c.to)}
                                        className="px-8 py-5 rounded-2xl bg-gradient-to-r from-electric-pink to-electric-blue text-white font-semibold text-lg hover:scale-105 transition-transform shadow-2xl shadow-electric-pink/30"
                                    >
                                        {c.label}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            function renderCTAGradient() {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center">
                        <div className="max-w-4xl mx-auto px-6 w-full text-center">
                            <div className="relative">
                                <div className="absolute inset-0 bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal rounded-3xl blur-2xl opacity-50"></div>
                                <div className="relative bg-gradient-to-br from-deep-navy/90 to-dark-slate-2/90 backdrop-blur-xl rounded-3xl p-12 border border-white/20">
                                    <h1 className="text-5xl md:text-7xl font-bold mb-6 bg-gradient-to-r from-white to-cyan-teal bg-clip-text text-transparent">
                                        {node.title}
                                    </h1>
                                    {node.subtitle && (
                                        <div className="text-2xl text-cyan-teal mb-8">{node.subtitle}</div>
                                    )}
                                    {node.body && (
                                        <p className="text-xl text-white/80 mb-12 leading-relaxed">
                                            {node.body}
                                        </p>
                                    )}
                                    <div className="flex flex-col sm:flex-row gap-4 justify-center">
                                        {node.choices?.map((c, idx) => (
                                            <button
                                                key={idx}
                                                onClick={() => go(c.to)}
                                                className="px-10 py-5 rounded-2xl bg-gradient-to-r from-electric-pink to-electric-blue text-white font-bold text-lg hover:scale-110 transition-all shadow-2xl"
                                            >
                                                {c.label}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            function renderAboutSplit() {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center">
                        <div className="max-w-7xl mx-auto px-6 w-full">
                            <div className="grid md:grid-cols-2 gap-8 lg:gap-16 items-center">
                                {/* Left Side - Title & Subtitle with Visual Accent */}
                                <div className="relative space-y-6">
                                    {/* Decorative accent line */}
                                    <div className="absolute -left-4 top-0 bottom-0 w-1 bg-gradient-to-b from-electric-pink via-electric-blue to-cyan-teal rounded-full opacity-60"></div>
                                    
                                    <div className="pl-8 space-y-6">
                                        <h1 className="text-5xl md:text-6xl lg:text-7xl font-bold text-white leading-[1.1]">
                                            {node.title}
                                        </h1>
                                        {node.subtitle && (
                                            <div className="text-xl md:text-2xl lg:text-3xl text-cyan-teal font-light leading-relaxed max-w-lg">
                                                {node.subtitle}
                                            </div>
                                        )}
                                    </div>
                                </div>

                                {/* Right Side - Body & Buttons with Card Design */}
                                <div className="relative">
                                    {/* Card container with glow effect */}
                                    <div className="relative bg-gradient-to-br from-dark-slate-2/60 via-dark-slate-2/40 to-deep-navy/60 backdrop-blur-xl rounded-3xl p-8 border border-white/10 shadow-2xl">
                                        {/* Glow effect */}
                                        <div className="absolute -inset-1 bg-gradient-to-r from-electric-pink/20 via-electric-blue/20 to-cyan-teal/20 rounded-3xl blur-xl opacity-50"></div>
                                        
                                        <div className="relative space-y-8">
                                            {node.body && (
                                                <div className="space-y-4">
                                                    <p className="text-base md:text-lg lg:text-xl text-white/95 leading-relaxed font-light">
                                                        {node.body}
                                                    </p>
                                                </div>
                                            )}
                                            
                                            {/* Divider */}
                                            <div className="h-px bg-gradient-to-r from-transparent via-white/20 to-transparent"></div>
                                            
                                            {/* Buttons */}
                                            <div className="flex flex-col gap-3">
                                                {node.choices?.map((c, idx) => (
                                                    <button
                                                        key={idx}
                                                        onClick={(e) => {
                                                            e.preventDefault();
                                                            e.stopPropagation();
                                                            go(c.to);
                                                        }}
                                                        className="group relative px-6 py-4 rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 hover:border-cyan-teal/40 text-white font-medium transition-all duration-300 text-left backdrop-blur-sm transform hover:scale-[1.02] hover:shadow-lg pointer-events-auto overflow-hidden"
                                                    >
                                                        {/* Gradient overlay on hover */}
                                                        <div className="absolute inset-0 bg-gradient-to-r from-electric-pink/0 via-electric-blue/0 to-cyan-teal/0 group-hover:from-electric-pink/15 group-hover:via-electric-blue/15 group-hover:to-cyan-teal/15 rounded-xl transition-all duration-300"></div>
                                                        
                                                        {/* Left accent line */}
                                                        <div className="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-electric-pink via-electric-blue to-cyan-teal opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-l-xl"></div>
                                                        
                                                        <span className="relative z-10 flex items-center justify-between">
                                                            <span>{c.label}</span>
                                                            <i className="fas fa-arrow-right opacity-0 group-hover:opacity-100 transform translate-x-[-10px] group-hover:translate-x-0 transition-all duration-300 text-cyan-teal"></i>
                                                        </span>
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            function renderLayeredPremium() {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center">
                        <div className="max-w-4xl mx-auto px-6 w-full">
                            <div className="relative">
                                <div className="absolute -inset-4 bg-gradient-to-r from-electric-pink/20 to-electric-blue/20 rounded-3xl blur-2xl"></div>
                                <div className="relative bg-dark-slate-2/80 backdrop-blur-xl rounded-3xl p-10 border border-white/10">
                                    <div className="flex items-center gap-4 mb-6">
                                        {node.icon && (
                                            <div className="text-5xl text-electric-pink">
                                                <i className={`fas ${getIconClass(node.icon)}`}></i>
                                            </div>
                                        )}
                                        <div>
                                            <div className="text-xs tracking-widest uppercase opacity-50">{node.eyebrow || 'LAYER'}</div>
                                            <h1 className="text-4xl font-bold">{node.title}</h1>
                                        </div>
                                    </div>
                                    {node.subtitle && (
                                        <div className="text-xl text-cyan-teal mb-6">{node.subtitle}</div>
                                    )}
                                    {node.body && (
                                        <p className="text-white/80 mb-8 leading-relaxed">{node.body}</p>
                                    )}
                                    <div className="grid sm:grid-cols-2 gap-4">
                                        {node.choices?.map((c, idx) => (
                                            <button
                                                key={idx}
                                                onClick={() => go(c.to)}
                                                className="px-6 py-4 rounded-xl bg-gradient-to-r from-electric-pink/20 to-electric-blue/20 hover:from-electric-pink/30 hover:to-electric-blue/30 border border-white/10 text-white font-medium transition-all"
                                            >
                                                {c.label}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            function renderServiceElegant() {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center">
                        <div className="max-w-5xl mx-auto px-6 w-full">
                            <div className="bg-gradient-to-br from-white/5 to-transparent backdrop-blur-2xl rounded-3xl p-12 border border-white/10 shadow-2xl">
                                <div className="text-xs tracking-[0.3em] uppercase opacity-50 mb-4">SERVICE</div>
                                <h1 className="text-5xl md:text-6xl font-bold mb-4">{node.title}</h1>
                                {node.subtitle && (
                                    <div className="text-2xl text-cyan-teal mb-8 font-light">{node.subtitle}</div>
                                )}
                                {node.body && (
                                    <div className="text-white/90 text-lg mb-10 leading-relaxed space-y-4">
                                        {node.body.split('.').filter(p => p.trim()).map((para, idx) => (
                                            <p key={idx}>{para.trim()}.</p>
                                        ))}
                                    </div>
                                )}
                                <div className="flex flex-wrap gap-4">
                                    {node.choices?.map((c, idx) => (
                                        <button
                                            key={idx}
                                            onClick={() => go(c.to)}
                                            className={`px-8 py-4 rounded-xl font-semibold transition-all ${
                                                idx === 0
                                                    ? 'bg-gradient-to-r from-electric-pink to-electric-blue text-white hover:scale-105 shadow-xl'
                                                    : 'bg-white/10 hover:bg-white/20 text-white border border-white/20'
                                            }`}
                                        >
                                            {c.label}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            function renderContactOptions() {
                const parseOptions = () => {
                    if (!node.body) return { option1: '', option2: '' };
                    const parts = node.body.split('Option 2:');
                    const option1 = parts[0]?.replace('Option 1:', '').trim() || '';
                    const option2 = parts[1]?.trim() || '';
                    return { option1, option2 };
                };
                const { option1, option2 } = parseOptions();

                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center overflow-y-auto py-12">
                        <div className="max-w-6xl mx-auto px-6 w-full">
                            <div className="text-center mb-12">
                                <h1 className="text-5xl md:text-7xl font-bold mb-4 bg-gradient-to-r from-white via-cyan-teal to-electric-pink bg-clip-text text-transparent">
                                    {node.title}
                                </h1>
                                {node.subtitle && (
                                    <div className="text-2xl text-cyan-teal mb-4">{node.subtitle}</div>
                                )}
                            </div>
                            
                            <div className="grid md:grid-cols-2 gap-8 mb-12">
                                <div className="relative group pointer-events-auto">
                                    <div className="absolute -inset-1 bg-gradient-to-r from-electric-pink to-electric-blue rounded-3xl blur opacity-30 group-hover:opacity-50 transition pointer-events-none"></div>
                                    <div className="relative bg-gradient-to-br from-dark-slate-2/90 to-deep-navy/90 backdrop-blur-xl rounded-3xl p-8 border border-white/10 h-full z-10">
                                        <div className="flex items-center gap-3 mb-6">
                                            <div className="w-12 h-12 rounded-full bg-gradient-to-r from-electric-pink to-electric-blue flex items-center justify-center text-white font-bold text-xl">
                                                1
                                            </div>
                                            <div className="text-2xl font-bold">AI Opportunity Scan</div>
                                        </div>
                                        <p className="text-white/80 text-lg leading-relaxed mb-6">
                                            {option1}
                                        </p>
                                        <button
                                            onClick={(e) => {
                                                e.preventDefault();
                                                e.stopPropagation();
                                                go('contact_form');
                                            }}
                                            className="w-full px-6 py-4 rounded-xl bg-gradient-to-r from-electric-pink to-electric-blue text-white font-semibold hover:scale-105 transition-transform shadow-lg cursor-pointer relative z-10 pointer-events-auto"
                                        >
                                            Book Your AI Opportunity Scan
                                        </button>
                                    </div>
                                </div>

                                <div className="relative group pointer-events-auto">
                                    <div className="absolute -inset-1 bg-gradient-to-r from-cyan-teal to-electric-blue rounded-3xl blur opacity-30 group-hover:opacity-50 transition pointer-events-none"></div>
                                    <div className="relative bg-gradient-to-br from-dark-slate-2/90 to-deep-navy/90 backdrop-blur-xl rounded-3xl p-8 border border-white/10 h-full z-10">
                                        <div className="flex items-center gap-3 mb-6">
                                            <div className="w-12 h-12 rounded-full bg-gradient-to-r from-cyan-teal to-electric-blue flex items-center justify-center text-white font-bold text-xl">
                                                2
                                            </div>
                                            <div className="text-2xl font-bold">Plug Into Growth Engine</div>
                                        </div>
                                        <p className="text-white/80 text-lg leading-relaxed mb-6">
                                            {option2}
                                        </p>
                                        <button
                                            onClick={(e) => {
                                                e.preventDefault();
                                                e.stopPropagation();
                                                go('contact_form');
                                            }}
                                            className="w-full px-6 py-4 rounded-xl bg-gradient-to-r from-cyan-teal to-electric-blue text-white font-semibold hover:scale-105 transition-transform shadow-lg cursor-pointer relative z-10 pointer-events-auto"
                                        >
                                            Plug Me Into the Growth Engine
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div className="flex flex-wrap justify-center gap-4 pointer-events-auto">
                                {node.choices?.map((c, idx) => (
                                    <button
                                        key={idx}
                                        onClick={(e) => {
                                            e.preventDefault();
                                            e.stopPropagation();
                                            go(c.to);
                                        }}
                                        className="px-6 py-3 rounded-xl bg-white/10 hover:bg-white/20 border border-white/20 text-white font-medium transition-all cursor-pointer relative z-10 pointer-events-auto"
                                    >
                                        {c.label}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            function renderContactForm() {
                if (!node) {
                    return (
                        <div className="relative z-10 h-[calc(100vh-84px)] flex items-center">
                            <div className="text-white">Loading...</div>
                        </div>
                    );
                }
                return <ContactFormComponent node={node} go={go} />;
            }

            function renderStackShowcase() {
                // Parse stack options from body and choices
                const stacks = [
                    {
                        name: 'AI Business Engine',
                        icon: 'fa-brain',
                        gradient: 'from-electric-pink via-electric-blue to-cyan-teal',
                        description: 'Five intelligent co-pilots unified. Executive assistance, business consulting, team coordination, onboarding, and revenue generation.',
                        target: 'business_engine_hero',
                        featured: true
                    },
                    {
                        name: 'AI Marketing Engine',
                        icon: 'fa-rocket',
                        gradient: 'from-cyan-teal to-electric-blue',
                        description: 'Content, social, video, and ads created and deployed automatically. Omnipresent brand visibility without the burnout.',
                        target: 'marketing_engine_hero',
                        featured: false
                    },
                    {
                        name: 'Visibility Stack',
                        icon: 'fa-chart-line',
                        gradient: 'from-electric-blue to-cyan-teal',
                        description: 'Rankings aren\'t enough. We engineer your brand to become the answer across search engines, voice assistants, and AI tools.',
                        target: 'visibility_hero',
                        featured: false
                    },
                    {
                        name: 'Knowledge & Scale Suite',
                        icon: 'fa-users',
                        gradient: 'from-warm-yellow to-electric-pink',
                        description: 'Turn your expertise into intelligent systems that train, sell, and support 24/7.',
                        target: 'knowledge_scale',
                        featured: false
                    },
                    {
                        name: 'Premium DFY Services',
                        icon: 'fa-gem',
                        gradient: 'from-electric-pink to-warm-yellow',
                        description: 'Bespoke AI strategy, revenue architecture, full-service brand and funnel design.',
                        target: 'dfy_hero',
                        featured: false
                    }
                ];

                // Find trust/validation choice
                const trustChoice = node.choices?.find(c => c.label.includes('Trust') || c.label.includes('Leaders'));

                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center overflow-hidden py-8">
                        <div className="max-w-[95vw] mx-auto w-full">
                            {/* Header */}
                            <div className="text-center mb-10">
                                <div className="inline-block px-4 py-2 rounded-full bg-gradient-to-r from-electric-pink/20 to-electric-blue/20 border border-electric-pink/30 mb-4">
                                    <span className="text-xs tracking-[0.3em] uppercase text-cyan-teal font-semibold">THE COMPLETE STACK</span>
                                </div>
                                <h1 className="text-4xl md:text-6xl font-bold mb-4 leading-tight">
                                    <span className="bg-gradient-to-r from-white via-cyan-teal to-electric-pink bg-clip-text text-transparent">
                                        {node.title}
                                    </span>
                                </h1>
                                {node.subtitle && (
                                    <div className="text-xl md:text-2xl text-cyan-teal mb-6 font-light max-w-4xl mx-auto">
                                        {node.subtitle}
                                    </div>
                                )}
                            </div>

                            {/* Stack Cards - Single Row */}
                            <div className="flex flex-row gap-4 md:gap-5 lg:gap-6 overflow-x-auto pb-4 snap-x snap-mandatory scrollbar-hide">
                                {stacks.map((stack, idx) => (
                                    <div
                                        key={idx}
                                        onClick={() => go(stack.target)}
                                        className="group relative cursor-pointer transform transition-all duration-500 hover:scale-105 flex-shrink-0 w-[calc(20%-16px)] min-w-[280px] md:min-w-[300px] snap-center"
                                    >
                                        {/* Animated glow effect */}
                                        <div className={`absolute -inset-1 bg-gradient-to-r ${stack.gradient} rounded-3xl blur-lg opacity-0 group-hover:opacity-60 transition-opacity duration-500`}></div>
                                        <div className={`absolute -inset-0.5 bg-gradient-to-r ${stack.gradient} rounded-3xl blur opacity-20 group-hover:opacity-40 transition-opacity duration-500`}></div>
                                        
                                        {/* Card */}
                                        <div className={`relative bg-gradient-to-br from-dark-slate-2/95 to-deep-navy/95 backdrop-blur-2xl rounded-3xl p-6 md:p-7 border border-white/10 h-full min-h-[420px] overflow-hidden group-hover:border-white/30 transition-all duration-500 ${
                                            stack.featured ? 'ring-2 ring-electric-pink/50' : ''
                                        }`}>
                                            {/* Animated background gradient */}
                                            <div className={`absolute inset-0 bg-gradient-to-br ${stack.gradient} opacity-0 group-hover:opacity-10 transition-opacity duration-500`}></div>
                                            
                                            {/* Content */}
                                            <div className="relative z-10 h-full flex flex-col">
                                                {/* Icon */}
                                                <div className={`mb-5 inline-flex items-center justify-center w-14 h-14 md:w-16 md:h-16 rounded-2xl bg-gradient-to-r ${stack.gradient} shadow-2xl transform group-hover:rotate-6 transition-transform duration-500`}>
                                                    <i className={`fas ${stack.icon} text-white text-xl md:text-2xl`}></i>
                                                </div>

                                                {/* Title */}
                                                <h3 className="text-xl md:text-2xl font-bold mb-3 text-white group-hover:text-cyan-teal transition-colors duration-300 leading-tight">
                                                    {stack.name}
                                                    {stack.featured && (
                                                        <span className="ml-2 text-xs bg-gradient-to-r from-electric-pink to-electric-blue text-white px-2 py-1 rounded-full">FEATURED</span>
                                                    )}
                                                </h3>

                                                {/* Description */}
                                                <p className="text-white/70 text-sm leading-relaxed mb-6 flex-grow line-clamp-4">
                                                    {stack.description}
                                                </p>

                                                {/* CTA Arrow */}
                                                <div className="flex items-center text-cyan-teal font-semibold group-hover:text-electric-pink transition-colors mt-auto">
                                                    <span className="text-xs uppercase tracking-wider">Explore</span>
                                                    <i className="fas fa-arrow-right ml-3 transform group-hover:translate-x-2 transition-transform duration-300"></i>
                                                </div>
                                            </div>

                                            {/* Shine effect on hover */}
                                            <div className="absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/10 to-transparent"></div>
                                        </div>
                                    </div>
                                ))}
                            </div>

                            {/* Trust CTA */}
                            {trustChoice && (
                                <div className="text-center mt-8">
                                    <button
                                        onClick={() => go(trustChoice.to)}
                                        className="group relative px-8 py-4 rounded-2xl bg-gradient-to-r from-electric-pink/20 via-electric-blue/20 to-cyan-teal/20 border-2 border-white/20 hover:border-white/40 backdrop-blur-xl text-white font-bold text-base md:text-lg transition-all duration-300 hover:scale-105 overflow-hidden"
                                    >
                                        <span className="relative z-10">{trustChoice.label}</span>
                                        <div className="absolute inset-0 bg-gradient-to-r from-electric-pink to-electric-blue opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>
                );
            }

            function renderProblemPremium() {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex flex-col justify-between py-12">
                        <div className="max-w-5xl mx-auto px-6 w-full flex-1 flex flex-col justify-center">
                            {/* Icon - Left aligned, above title */}
                            {node.icon && (
                                <div className="mb-6">
                                    <div className="relative inline-flex items-center justify-center w-14 h-14 rounded-xl bg-gradient-to-br from-electric-pink/20 via-electric-blue/20 to-cyan-teal/20 border-2 border-electric-pink/40 backdrop-blur-sm">
                                        <i className={`fas ${getIconClass(node.icon)} text-electric-pink text-xl`}></i>
                                    </div>
                                </div>
                            )}

                            {/* Headline - Main focus, left aligned */}
                            <h1 className="text-4xl md:text-5xl lg:text-6xl font-bold mb-6 leading-tight text-white text-left max-w-4xl">
                                {node.title}
                            </h1>

                            {/* Body text - Clear spacing and readability */}
                            {node.body && (
                                <div className="mb-12 max-w-3xl">
                                    <p className="text-base md:text-lg text-white/85 leading-relaxed text-left">
                                        {node.body}
                                    </p>
                                </div>
                            )}
                        </div>

                        {/* Buttons at bottom - Left aligned to match content */}
                        <div className="max-w-5xl mx-auto px-6 w-full">
                            <div className="flex flex-col sm:flex-row gap-4 justify-start items-start sm:items-center">
                                {node.choices?.map((c, idx) => (
                                    <button
                                        key={idx}
                                        onClick={(e) => {
                                            e.preventDefault();
                                            e.stopPropagation();
                                            go(c.to);
                                        }}
                                        className={`group relative px-6 py-4 rounded-xl font-semibold text-base transition-all duration-300 transform hover:scale-105 hover:shadow-xl overflow-hidden pointer-events-auto ${
                                            idx === 0
                                                ? 'bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal text-white'
                                                : 'bg-white/10 hover:bg-white/15 border border-white/20 text-white backdrop-blur-sm'
                                        }`}
                                    >
                                        {/* Shine effect for primary button */}
                                        {idx === 0 && (
                                            <div className="absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/30 to-transparent"></div>
                                        )}
                                        
                                        {/* Button content */}
                                        <span className="relative z-10 flex items-center">
                                            {c.label}
                                            {idx === 0 && (
                                                <i className="fas fa-arrow-right ml-2 transform group-hover:translate-x-1 transition-transform duration-300"></i>
                                            )}
                                        </span>
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            function CoPilotsNetworkComponent({ node, go }) {
                // Define the five co-pilots
                const coPilots = [
                    {
                        id: 'A',
                        name: 'The Executive Assistant',
                        icon: 'fa-user-tie',
                        gradient: 'from-electric-pink via-electric-blue to-cyan-teal',
                        metric: 'Reclaim 40% of your administrative tasks permanently.',
                        outcome: 'Founders report gaining back an entire workday every week.',
                        target: 'business_engine_module_a',
                        position: 'center'
                    },
                    {
                        id: 'B',
                        name: 'The Business Consultant',
                        icon: 'fa-chart-line',
                        gradient: 'from-cyan-teal to-electric-blue',
                        metric: '35% cost reduction within 90 days.',
                        target: 'business_engine_module_b',
                        position: 'top-right'
                    },
                    {
                        id: 'C',
                        name: 'The Team Assistant & Onboarding Engine',
                        icon: 'fa-rocket',
                        gradient: 'from-electric-blue to-cyan-teal',
                        metric: '50% faster ramp-up â€” 30% less turnover.',
                        target: 'business_engine_module_c',
                        position: 'bottom-right'
                    },
                    {
                        id: 'D',
                        name: 'The Team Coordinator',
                        icon: 'fa-users',
                        gradient: 'from-warm-yellow to-electric-pink',
                        metric: '55% operational efficiency gain.',
                        target: 'business_engine_module_d',
                        position: 'bottom-left'
                    },
                    {
                        id: 'E',
                        name: 'The Sales Engine',
                        icon: 'fa-bullhorn',
                        gradient: 'from-electric-pink to-warm-yellow',
                        metric: '30% more leads â€” 67% higher conversions.',
                        target: 'business_engine_module_e',
                        position: 'top-left'
                    }
                ];

                const [activeTab, setActiveTab] = useState('Overview');
                const [currentModule, setCurrentModule] = useState(0); // 0 = Module A (center)

                const centerModule = coPilots[0];
                const surroundingModules = coPilots.slice(1);

                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center overflow-hidden py-8">
                        <div className="max-w-7xl mx-auto px-6 w-full h-full flex flex-col">
                            {/* Header */}
                            <div className="text-center mb-8">
                                <h1 className="text-5xl md:text-6xl font-bold mb-2">
                                    <span className="bg-gradient-to-r from-white via-cyan-teal to-electric-pink bg-clip-text text-transparent">
                                        {node.title}
                                    </span>
                                </h1>
                                {node.subtitle && (
                                    <div className="text-xl md:text-2xl text-cyan-teal font-light">
                                        {node.subtitle}
                                    </div>
                                )}
                            </div>

                            {/* Network Layout */}
                            <div className="flex-1 relative flex items-center justify-center">
                                {/* Connecting Lines */}
                                <svg className="absolute inset-0 w-full h-full pointer-events-none z-10">
                                    {/* Lines from center to surrounding modules */}
                                    {surroundingModules.map((module, idx) => {
                                        const positions = {
                                            'top-left': { x: '20%', y: '20%' },
                                            'top-right': { x: '80%', y: '20%' },
                                            'bottom-left': { x: '20%', y: '80%' },
                                            'bottom-right': { x: '80%', y: '80%' }
                                        };
                                        const pos = positions[module.position];
                                        return (
                                            <line
                                                key={idx}
                                                x1="50%"
                                                y1="50%"
                                                x2={pos.x}
                                                y2={pos.y}
                                                stroke="url(#gradient)"
                                                strokeWidth="2"
                                                opacity="0.4"
                                                className="animate-pulse"
                                            />
                                        );
                                    })}
                                    <defs>
                                        <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" stopColor="#ff007a" stopOpacity="0.6" />
                                            <stop offset="50%" stopColor="#00a8ff" stopOpacity="0.6" />
                                            <stop offset="100%" stopColor="#00d4ff" stopOpacity="0.6" />
                                        </linearGradient>
                                    </defs>
                                </svg>

                                {/* Surrounding Modules (Smaller Cards) */}
                                {surroundingModules.map((module, idx) => {
                                    const positions = {
                                        'top-left': 'absolute top-0 left-0',
                                        'top-right': 'absolute top-0 right-0',
                                        'bottom-left': 'absolute bottom-0 left-0',
                                        'bottom-right': 'absolute bottom-0 right-0'
                                    };
                                    return (
                                        <div
                                            key={idx}
                                            onClick={() => go(module.target)}
                                            className={`${positions[module.position]} w-48 h-32 cursor-pointer transform hover:scale-110 transition-all duration-300 group z-20`}
                                        >
                                            <div className="relative bg-gradient-to-br from-dark-slate-2/90 to-deep-navy/90 backdrop-blur-xl rounded-2xl p-4 border border-white/20 h-full hover:border-white/40 transition-all shadow-xl">
                                                <div className={`absolute -inset-1 bg-gradient-to-r ${module.gradient} rounded-2xl blur opacity-0 group-hover:opacity-60 transition-opacity`}></div>
                                                <div className="relative z-10 h-full flex flex-col">
                                                    <div className={`inline-flex items-center justify-center w-10 h-10 rounded-full bg-gradient-to-r ${module.gradient} mb-2`}>
                                                        <i className={`fas ${module.icon} text-white text-lg`}></i>
                                                    </div>
                                                    <div className="text-white font-bold text-sm mb-1">{module.id}</div>
                                                    <div className="text-white/80 text-xs leading-tight">{module.name}</div>
                                                </div>
                                            </div>
                                        </div>
                                    );
                                })}

                                {/* Central Module Card (Large) */}
                                <div className="relative w-full max-w-2xl mx-auto z-30">
                                    <div className="relative bg-gradient-to-br from-dark-slate-2/95 via-deep-navy/95 to-dark-slate-2/95 backdrop-blur-2xl rounded-3xl p-8 border border-white/20 shadow-2xl overflow-hidden">
                                        {/* Glow effects */}
                                        <div className="absolute -inset-4 bg-gradient-to-r from-electric-pink/30 via-electric-blue/30 to-cyan-teal/30 rounded-3xl blur-2xl opacity-60 animate-pulse"></div>
                                        
                                        {/* Top accent line */}
                                        <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal"></div>

                                        {/* Module Badge */}
                                        <div className="flex items-center gap-4 mb-6">
                                            <div className={`w-16 h-16 rounded-full bg-gradient-to-r ${centerModule.gradient} flex items-center justify-center shadow-2xl`}>
                                                <span className="text-white text-2xl font-bold">{centerModule.id}</span>
                                            </div>
                                            <h2 className="text-2xl md:text-3xl font-bold text-white">{centerModule.name}</h2>
                                        </div>

                                        {/* Tabs */}
                                        <div className="flex gap-2 mb-6 border-b border-white/10">
                                            {['Overview', 'Detail', 'All points'].map((tab) => (
                                                <button
                                                    key={tab}
                                                    onClick={() => setActiveTab(tab)}
                                                    className={`px-4 py-2 text-sm font-semibold transition-all ${
                                                        activeTab === tab
                                                            ? 'text-cyan-teal border-b-2 border-cyan-teal'
                                                            : 'text-white/60 hover:text-white/80'
                                                    }`}
                                                >
                                                    {tab}
                                                </button>
                                            ))}
                                        </div>

                                        {/* Content based on active tab */}
                                        <div className="mb-6">
                                            {activeTab === 'Overview' && (
                                                <div>
                                                    <p className="text-white/90 text-lg mb-4">{centerModule.outcome}</p>
                                                    <div className="px-6 py-4 rounded-2xl bg-gradient-to-r from-electric-pink/20 to-cyan-teal/20 border border-cyan-teal/30">
                                                        <p className="text-cyan-teal font-bold text-xl">{centerModule.metric}</p>
                                                    </div>
                                                </div>
                                            )}
                                            {activeTab === 'Detail' && (
                                                <div>
                                                    <p className="text-white/80 text-base leading-relaxed">{node.body}</p>
                                                </div>
                                            )}
                                            {activeTab === 'All points' && (
                                                <div>
                                                    <p className="text-white/80 text-sm leading-relaxed whitespace-pre-line">{node.body}</p>
                                                </div>
                                            )}
                                        </div>

                                        {/* Navigation */}
                                        <div className="flex items-center justify-between text-white/60 text-sm">
                                            <button className="hover:text-white transition-colors">â† Previous</button>
                                            <span>1 / 5</span>
                                            <button className="hover:text-white transition-colors">Next â†’</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* Bottom CTA Buttons */}
                            <div className="flex flex-col sm:flex-row gap-4 justify-center mt-8">
                                {node.choices?.slice(0, 2).map((c, idx) => (
                                    <button
                                        key={idx}
                                        onClick={(e) => {
                                            e.preventDefault();
                                            e.stopPropagation();
                                            go(c.to);
                                        }}
                                        className="group relative px-8 py-5 rounded-2xl font-bold text-lg transition-all duration-300 transform hover:scale-105 hover:shadow-2xl overflow-hidden pointer-events-auto bg-gradient-to-br from-dark-slate-2/90 to-deep-navy/90 backdrop-blur-xl border-2 border-white/20 hover:border-cyan-teal/50 text-white"
                                    >
                                        <div className="absolute inset-0 bg-gradient-to-r from-electric-pink/20 via-electric-blue/20 to-cyan-teal/20 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                                        <span className="relative z-10">{c.label}</span>
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            function renderCoPilotsNetwork() {
                return <CoPilotsNetworkComponent node={node} go={go} />;
            }

            function renderProcessSteps() {
                // Parse numbered steps from body
                const parseSteps = (body) => {
                    if (!body) return [];
                    const stepRegex = /(\d+)\.\s*([^â€”]+)\s*â€”\s*([^0-9]+?)(?=\s*\d+\.|$)/g;
                    const steps = [];
                    let match;
                    while ((match = stepRegex.exec(body)) !== null) {
                        steps.push({
                            number: match[1],
                            title: match[2].trim(),
                            description: match[3].trim()
                        });
                    }
                    // Fallback: if regex doesn't work, try splitting by numbers
                    if (steps.length === 0) {
                        const parts = body.split(/\d+\./).filter(p => p.trim());
                        parts.forEach((part, idx) => {
                            const [title, ...descParts] = part.split('â€”');
                            steps.push({
                                number: (idx + 1).toString(),
                                title: title?.trim() || '',
                                description: descParts.join('â€”').trim() || ''
                            });
                        });
                    }
                    return steps;
                };

                const steps = parseSteps(node.body);

                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex flex-col justify-between py-12">
                        <div className="max-w-5xl mx-auto px-6 w-full flex-1 flex flex-col justify-center">
                            {/* Eyebrow */}
                            {node.eyebrow && (
                                <div className="text-xs tracking-[0.3em] uppercase text-white/60 mb-4 font-light">
                                    {node.eyebrow}
                                </div>
                            )}

                            {/* Title */}
                            <h1 className="text-4xl md:text-5xl lg:text-6xl font-bold mb-4 text-white">
                                {node.title}
                            </h1>

                            {/* Subtitle */}
                            {node.subtitle && (
                                <div className="text-xl md:text-2xl text-cyan-teal mb-12 font-light">
                                    {node.subtitle}
                                </div>
                            )}

                            {/* Process Steps */}
                            <div className="space-y-6 mb-12">
                                {steps.map((step, idx) => (
                                    <div key={idx} className="relative pl-16">
                                        {/* Step Number */}
                                        <div className="absolute left-0 top-0 w-12 h-12 rounded-full bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal flex items-center justify-center shadow-lg">
                                            <span className="text-white font-bold text-lg">{step.number}</span>
                                        </div>

                                        {/* Step Content */}
                                        <div>
                                            <h3 className="text-xl md:text-2xl font-bold text-white mb-2">
                                                {step.title}
                                            </h3>
                                            <p className="text-base md:text-lg text-white/85 leading-relaxed">
                                                {step.description}
                                            </p>
                                        </div>

                                        {/* Connecting line (except last) */}
                                        {idx < steps.length - 1 && (
                                            <div className="absolute left-6 top-12 w-0.5 h-full bg-gradient-to-b from-electric-pink via-electric-blue to-cyan-teal opacity-30"></div>
                                        )}
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* Buttons */}
                        <div className="max-w-5xl mx-auto px-6 w-full">
                            <div className="flex flex-col sm:flex-row gap-4 justify-center">
                                {node.choices?.map((c, idx) => (
                                    <button
                                        key={idx}
                                        onClick={(e) => {
                                            e.preventDefault();
                                            e.stopPropagation();
                                            go(c.to);
                                        }}
                                        className={`group relative px-8 py-5 rounded-2xl font-bold text-base md:text-lg transition-all duration-300 transform hover:scale-105 hover:shadow-2xl overflow-hidden pointer-events-auto ${
                                            idx === 0
                                                ? 'bg-gradient-to-r from-electric-pink via-electric-blue to-cyan-teal text-white'
                                                : 'bg-white/10 hover:bg-white/15 border border-white/20 text-white backdrop-blur-sm'
                                        }`}
                                    >
                                        {idx === 0 && (
                                            <div className="absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/30 to-transparent"></div>
                                        )}
                                        <span className="relative z-10">{c.label}</span>
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            function renderStatementPremium() {
                return (
                    <div className="relative z-10 h-[calc(100vh-84px)] flex items-center">
                        <div className="max-w-4xl mx-auto px-6 w-full">
                            {node.eyebrow && (
                                <div className="text-xs tracking-[0.3em] uppercase opacity-50 mb-4">{node.eyebrow}</div>
                            )}
                            {node.icon && (
                                <div className="text-5xl text-electric-pink mb-6">
                                    <i className={`fas ${getIconClass(node.icon)}`}></i>
                                </div>
                            )}
                            <h1 className="text-lg md:text-2xl font-bold mb-6">{node.title}</h1>
                            {node.subtitle && (
                                <div className="text-2xl text-cyan-teal mb-8 font-light">{node.subtitle}</div>
                            )}
                            {node.body && (
                                <p className="text-lg text-white/80 mb-10 leading-relaxed">{node.body}</p>
                            )}
                            <div className="flex flex-col sm:flex-row gap-4">
                                {node.choices?.map((c, idx) => (
                                    <button
                                        key={idx}
                                        onClick={() => go(c.to)}
                                        className={`px-8 py-4 rounded-xl font-semibold transition-all ${
                                            idx === 0
                                                ? 'bg-gradient-to-r from-electric-pink to-electric-blue text-white hover:scale-105'
                                                : 'bg-white/10 hover:bg-white/20 text-white border border-white/20'
                                        }`}
                                    >
                                        {c.label}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            // Background variations based on design
            function getBackground() {
                const bgVariants = {
                    'hero-premium': (
                        <>
                            <div className="absolute -top-40 left-1/2 h-[600px] w-[600px] -translate-x-1/2 rounded-full bg-gradient-to-r from-electric-pink/20 via-electric-blue/20 to-cyan-teal/20 blur-3xl animate-pulse" />
                            <div className="absolute -bottom-48 right-[-120px] h-[600px] w-[600px] rounded-full bg-gradient-to-r from-cyan-teal/20 to-electric-blue/20 blur-3xl" />
                            <div className="absolute inset-0 bg-gradient-to-b from-white/0 via-electric-pink/5 to-deep-navy/60" />
                        </>
                    ),
                    'hero-split': (
                        <>
                            <div className="absolute inset-0 bg-gradient-to-br from-deep-navy via-dark-slate-2 to-deep-navy" />
                            <div className="absolute top-0 left-0 h-[500px] w-[500px] rounded-full bg-gradient-to-r from-electric-pink/15 via-electric-blue/15 to-cyan-teal/15 blur-3xl"></div>
                            <div className="absolute bottom-0 right-0 h-[500px] w-[500px] rounded-full bg-gradient-to-r from-cyan-teal/15 via-electric-blue/15 to-electric-pink/15 blur-3xl"></div>
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_30%_50%,rgba(255,0,122,0.08),transparent_70%)]"></div>
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_70%_50%,rgba(0,224,255,0.08),transparent_70%)]"></div>
                            <div className="absolute inset-0 bg-gradient-to-b from-transparent via-electric-blue/3 to-transparent"></div>
                        </>
                    ),
                    'module-card': (
                        <>
                            <div className="absolute inset-0 bg-gradient-to-br from-deep-navy via-dark-slate-2 to-deep-navy" />
                            {/* Animated orbs */}
                            <div className="absolute top-1/4 left-1/4 h-[500px] w-[500px] rounded-full bg-gradient-to-r from-electric-pink/15 via-electric-pink/8 to-transparent blur-3xl animate-pulse"></div>
                            <div className="absolute bottom-1/4 right-1/4 h-[500px] w-[500px] rounded-full bg-gradient-to-l from-cyan-teal/15 via-cyan-teal/8 to-transparent blur-3xl"></div>
                            <div className="absolute top-1/2 left-1/2 h-[400px] w-[400px] -translate-x-1/2 -translate-y-1/2 rounded-full bg-gradient-to-r from-electric-blue/10 via-electric-pink/10 to-cyan-teal/10 blur-3xl"></div>
                            {/* Radial gradients for depth */}
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_30%_40%,rgba(255,0,122,0.1),transparent_60%)]"></div>
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_70%_60%,rgba(0,224,255,0.1),transparent_60%)]"></div>
                            {/* Subtle grid overlay */}
                            <div className="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.02)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.02)_1px,transparent_1px)] bg-[size:40px_40px]"></div>
                        </>
                    ),
                    'comparison-table': (
                        <>
                            <div className="absolute inset-0 bg-gradient-to-b from-deep-navy to-dark-slate-2" />
                            <div className="absolute top-0 left-0 h-full w-1/2 bg-gradient-to-r from-electric-blue/5 to-transparent" />
                        </>
                    ),
                    'metrics-grid': (
                        <>
                            <div className="absolute inset-0 bg-gradient-to-br from-deep-navy via-electric-blue/10 to-dark-slate-2" />
                            <div className="absolute top-1/4 right-1/4 h-[300px] w-[300px] rounded-full bg-electric-pink/15 blur-3xl" />
                            <div className="absolute bottom-1/4 left-1/4 h-[300px] w-[300px] rounded-full bg-cyan-teal/15 blur-3xl" />
                        </>
                    ),
                    'cta-gradient': (
                        <>
                            <div className="absolute inset-0 bg-gradient-to-br from-deep-navy via-dark-slate-2 to-deep-navy" />
                            <div className="absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(255,0,122,0.1),transparent_70%)]" />
                            <div className="absolute inset-0 bg-[radial-gradient(circle_at_80%_20%,rgba(0,224,255,0.1),transparent_70%)]" />
                        </>
                    ),
                    'about-split': (
                        <>
                            <div className="absolute inset-0 bg-gradient-to-br from-deep-navy via-dark-slate-2 to-deep-navy" />
                            {/* Subtle purple hint in upper right */}
                            <div className="absolute top-0 right-0 h-1/2 w-1/2 bg-gradient-to-bl from-purple-900/20 via-transparent to-transparent"></div>
                            {/* Animated gradient orbs */}
                            <div className="absolute top-1/4 left-1/4 h-[400px] w-[400px] rounded-full bg-gradient-to-r from-electric-pink/10 via-electric-blue/10 to-cyan-teal/10 blur-3xl animate-pulse"></div>
                            <div className="absolute bottom-1/4 right-1/4 h-[400px] w-[400px] rounded-full bg-gradient-to-l from-cyan-teal/10 via-electric-blue/10 to-electric-pink/10 blur-3xl"></div>
                            {/* Subtle radial gradients */}
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_30%_40%,rgba(255,0,122,0.08),transparent_60%)]"></div>
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_70%_60%,rgba(0,224,255,0.08),transparent_60%)]"></div>
                            {/* Grid overlay for texture */}
                            <div className="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.015)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.015)_1px,transparent_1px)] bg-[size:50px_50px]"></div>
                        </>
                    ),
                    'contact-options': (
                        <>
                            <div className="absolute inset-0 bg-gradient-to-br from-deep-navy via-dark-slate-2 to-deep-navy" />
                            <div className="absolute top-1/4 left-1/4 h-[400px] w-[400px] rounded-full bg-electric-pink/10 blur-3xl" />
                            <div className="absolute bottom-1/4 right-1/4 h-[400px] w-[400px] rounded-full bg-cyan-teal/10 blur-3xl" />
                            <div className="absolute inset-0 bg-gradient-to-b from-transparent via-electric-blue/5 to-transparent" />
                        </>
                    ),
                    'contact-form-premium': (
                    <>
                        {/* Base: deep, quiet */}
                        <div className="absolute inset-0 bg-gradient-to-b from-deep-navy via-dark-slate-2 to-black" />

                        {/* Horizon / vignette (makes the center feel â€œlitâ€) */}
                        <div className="absolute inset-0 bg-[radial-gradient(1200px_700px_at_50%_38%,rgba(255,255,255,0.07),transparent_62%)]" />
                        <div className="absolute inset-0 bg-[radial-gradient(900px_520px_at_50%_95%,rgba(0,0,0,0.55),transparent_60%)]" />

                        {/* Controlled accent washes (no hard halves) */}
                        <div className="absolute inset-0 bg-[radial-gradient(800px_520px_at_25%_45%,rgba(255,0,122,0.10),transparent_60%)]" />
                        <div className="absolute inset-0 bg-[radial-gradient(820px_540px_at_75%_50%,rgba(0,224,255,0.10),transparent_62%)]" />

                        {/* Soft diagonal light (adds â€œstudioâ€ feel) */}
                        <div className="absolute inset-0 bg-[linear-gradient(115deg,rgba(255,255,255,0.06),transparent_35%,transparent_70%,rgba(255,255,255,0.04))] opacity-60" />

                        {/* Subtle grid/mesh (premium tech cue) */}
                        <div className="absolute inset-0 opacity-[0.10] mix-blend-soft-light
                        bg-[linear-gradient(to_right,rgba(255,255,255,0.10)_1px,transparent_1px),
                            linear-gradient(to_bottom,rgba(255,255,255,0.10)_1px,transparent_1px)]
                        [background-size:72px_72px]" />

                        {/* Grain (no asset) */}
                        <div className="absolute inset-0 opacity-[0.08] mix-blend-overlay
                        bg-[radial-gradient(circle_at_1px_1px,rgba(255,255,255,0.35)_1px,transparent_1px)]
                        [background-size:3px_3px]" />

                        {/* Top fade for nav readability */}
                        <div className="absolute inset-x-0 top-0 h-28 bg-gradient-to-b from-black/50 to-transparent" />
                    </>
                    ),

                    'stack-showcase': (
                        <>
                            <div className="absolute inset-0 bg-gradient-to-br from-deep-navy via-dark-slate-2 to-deep-navy" />
                            <div className="absolute top-0 left-1/4 h-[600px] w-[600px] rounded-full bg-gradient-to-r from-electric-pink/15 via-electric-blue/15 to-cyan-teal/15 blur-3xl animate-pulse"></div>
                            <div className="absolute bottom-0 right-1/4 h-[600px] w-[600px] rounded-full bg-gradient-to-r from-cyan-teal/15 via-electric-blue/15 to-electric-pink/15 blur-3xl"></div>
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_center,rgba(255,0,122,0.08),transparent_70%)]"></div>
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_80%_20%,rgba(0,224,255,0.08),transparent_70%)]"></div>
                            <div className="absolute inset-0 bg-gradient-to-b from-transparent via-electric-blue/3 to-transparent"></div>
                        </>
                    ),
                    'problem-premium': (
                        <>
                            <div className="absolute inset-0 bg-gradient-to-br from-deep-navy via-dark-slate-2 to-deep-navy" />
                            {/* Animated orbs */}
                            <div className="absolute top-1/4 left-0 h-[500px] w-[500px] rounded-full bg-gradient-to-r from-electric-pink/20 via-electric-pink/10 to-transparent blur-3xl animate-pulse"></div>
                            <div className="absolute bottom-1/4 right-0 h-[500px] w-[500px] rounded-full bg-gradient-to-l from-cyan-teal/20 via-cyan-teal/10 to-transparent blur-3xl"></div>
                            <div className="absolute top-1/2 left-1/2 h-[400px] w-[400px] -translate-x-1/2 -translate-y-1/2 rounded-full bg-gradient-to-r from-electric-blue/15 via-electric-pink/15 to-cyan-teal/15 blur-3xl"></div>
                            {/* Radial gradients for depth */}
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_20%_30%,rgba(255,0,122,0.12),transparent_60%)]"></div>
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_80%_70%,rgba(0,224,255,0.12),transparent_60%)]"></div>
                            {/* Grid overlay for texture */}
                            <div className="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.02)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.02)_1px,transparent_1px)] bg-[size:50px_50px]"></div>
                            {/* Animated light streaks */}
                            <div className="absolute top-0 left-1/4 w-px h-full bg-gradient-to-b from-transparent via-electric-pink/20 to-transparent animate-pulse"></div>
                            <div className="absolute top-0 right-1/3 w-px h-full bg-gradient-to-b from-transparent via-cyan-teal/20 to-transparent animate-pulse animate-pulse-delay-1000"></div>
                        </>
                    ),
                    'co-pilots-network': (
                        <>
                            <div className="absolute inset-0 bg-gradient-to-br from-deep-navy via-dark-slate-2 to-deep-navy" />
                            {/* Star-like particles effect */}
                            <div className="absolute inset-0 bg-[radial-gradient(2px_2px_at_20%_30%,rgba(255,255,255,0.3),transparent),radial-gradient(2px_2px_at_60%_70%,rgba(255,255,255,0.2),transparent),radial-gradient(1px_1px_at_50%_50%,rgba(255,255,255,0.4),transparent)] bg-[length:200%_200%] animate-pulse"></div>
                            {/* Glowing rings */}
                            <div className="absolute top-1/2 left-1/2 h-[600px] w-[600px] -translate-x-1/2 -translate-y-1/2 rounded-full border border-electric-pink/20 blur-xl"></div>
                            <div className="absolute top-1/2 left-1/2 h-[800px] w-[800px] -translate-x-1/2 -translate-y-1/2 rounded-full border border-cyan-teal/15 blur-2xl"></div>
                            {/* Animated orbs */}
                            <div className="absolute top-1/4 left-1/4 h-[400px] w-[400px] rounded-full bg-gradient-to-r from-electric-pink/15 via-electric-blue/15 to-cyan-teal/15 blur-3xl animate-pulse"></div>
                            <div className="absolute bottom-1/4 right-1/4 h-[400px] w-[400px] rounded-full bg-gradient-to-l from-cyan-teal/15 via-electric-blue/15 to-electric-pink/15 blur-3xl"></div>
                            {/* Radial gradients */}
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_center,rgba(255,0,122,0.08),transparent_70%)]"></div>
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_80%_20%,rgba(0,224,255,0.08),transparent_70%)]"></div>
                        </>
                    ),
                    'process-steps': (
                        <>
                            <div className="absolute inset-0 bg-gradient-to-br from-deep-navy via-dark-slate-2 to-deep-navy" />
                            {/* Animated gradient orbs */}
                            <div className="absolute top-1/4 left-1/4 h-[500px] w-[500px] rounded-full bg-gradient-to-r from-electric-pink/20 via-electric-blue/20 to-cyan-teal/20 blur-3xl animate-pulse"></div>
                            <div className="absolute bottom-1/4 right-1/4 h-[500px] w-[500px] rounded-full bg-gradient-to-l from-cyan-teal/20 via-electric-blue/20 to-electric-pink/20 blur-3xl"></div>
                            {/* Subtle radial gradients */}
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_30%_40%,rgba(255,0,122,0.12),transparent_60%)]"></div>
                            <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_70%_60%,rgba(0,224,255,0.12),transparent_60%)]"></div>
                            {/* Grid overlay */}
                            <div className="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.02)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.02)_1px,transparent_1px)] bg-[size:40px_40px]"></div>
                        </>
                    ),
                    default: (
                        <>
                            <div className="absolute -top-40 left-1/2 h-[520px] w-[520px] -translate-x-1/2 rounded-full bg-electric-pink/10 blur-3xl" />
                            <div className="absolute -bottom-48 right-[-120px] h-[520px] w-[520px] rounded-full bg-electric-blue/10 blur-3xl" />
                            <div className="absolute inset-0 bg-gradient-to-b from-white/0 via-white/0 to-deep-navy/50" />
                        </>
                    )
                };
                return bgVariants[designVariant] || bgVariants.default;
            }

            return (
                <div className="h-screen w-full overflow-hidden bg-deep-navy text-white relative">
                    {/* Floating Particles - Always visible */}
                    <FloatingParticles />

                    {/* Dynamic background based on design variant with transition */}
                    <div className={`absolute inset-0 pointer-events-none transition-opacity duration-500 ${isTransitioning ? 'opacity-0' : 'opacity-100'}`}>
                        {getBackground()}
                    </div>

                    {/* Top controls */}
                    <div className={`relative z-20 max-w-6xl mx-auto px-6 pt-6 flex items-center justify-between transition-opacity duration-300 ${isTransitioning ? 'opacity-50' : 'opacity-100'}`}>
                        <div className="flex items-center gap-2">
                            <button
                                onClick={back}
                                disabled={history.length === 0 || isTransitioning}
                                className="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/15 disabled:opacity-40 disabled:hover:bg-white/10 transition backdrop-blur-sm pointer-events-auto"
                                aria-label="Back"
                            >
                                <i className="fas fa-arrow-left"></i>
                            </button>
                            <button
                                onClick={home}
                                disabled={isTransitioning}
                                className="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/15 transition backdrop-blur-sm pointer-events-auto"
                                aria-label="Home"
                            >
                                <i className="fas fa-home"></i>
                            </button>
                        </div>
                        <div className="text-xs tracking-[0.28em] uppercase opacity-60 hidden md:block">
                            Katalyst Â· AI Growth Engine
                        </div>
                    </div>

                    {/* Content with morph transition */}
                    <div className={`relative z-10 transition-all duration-600 ease-in-out ${isTransitioning ? 'opacity-0 scale-95 blur-sm' : 'opacity-100 scale-100 blur-0 page-enter'}`}>
                        {renderDesign()}
                    </div>
                </div>
            );
        }

        // Initialize the app
        function initJourney() {
            const root = document.getElementById('journey-root');
            if (!root) {
                console.log('journey-root not found, retrying...');
                setTimeout(initJourney, 100);
                return;
            }

            try {
                console.log('Rendering React component...');
                ReactDOM.render(<NoScrollJourney />, root);
            } catch (error) {
                console.error('Error rendering React component:', error);
                root.innerHTML = '<div style="padding: 20px; color: white; background: #020B2E; min-height: 100vh; text-align: center;"><h1>Error Loading Page</h1><p>Please refresh the page. Check browser console (F12) for details.</p><p style="color: red; margin-top: 20px;">Error: ' + (error.message || error.toString()) + '</p></div>';
            }
        }

        // Wait for DOM to be ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(initJourney, 100);
            });
        } else {
            setTimeout(initJourney, 100);
        }
    }

    // Start initialization
    initReactApp();
</script>
